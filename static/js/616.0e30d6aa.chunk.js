"use strict";(self.webpackChunkmia_erp=self.webpackChunkmia_erp||[]).push([[616,433,495],{6433:function(e,n,o){o.r(n),o.d(n,{default:function(){return X}});var i=o(168),t=o(1413),l=o(4942),r=o(9439),c=o(4925),a=o(8839),d=o(2791),s=o(3350),u=o(8495),v=o(7348),p=o(9264),m=o(3433),f=o(3665),y=o(7689),h=o(3185),g=o(1819),x=o(7824),w=o(401),C=o(107),I=o(1771),_=o(2410),S=function(e){var n,o=e.ctx,i=e.router,t=e.service;return{name:"enterCompany",title:"\u041f\u0435\u0440\u0435\u0439\u0442\u0438",icon:"logIn",disabled:!(null!==(n=o.selectedRow)&&void 0!==n&&n._id),iconSize:"100%",type:"onlyIcon",onClick:function(){var e,n;(console.log(o.selectedRow),null!==(e=o.selectedRow)&&void 0!==e&&e._id)&&t.logIn({data:{_id:null===(n=o.selectedRow)||void 0===n?void 0:n._id},onSuccess:function(e){var n,o,t,l;if(!e._id)return console.log("data",e);I.kl.success('Welcome: "'.concat((null===(n=e.company)||void 0===n||null===(o=n.name)||void 0===o?void 0:o.first)||(null===(t=e.company)||void 0===t||null===(l=t.label)||void 0===l?void 0:l.base),'"')),i.push({pathname:"/app/".concat(e._id)})},onError:function(e){console.log(e)}})}}},k=function(e){var n,o=e.ctx,i=e.companyType,t=e.modalService;return{name:"editCompany",title:"\u0420\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u0442\u0438",icon:"edit",disabled:null===(n=o.selectedRow)||void 0===n||!n._id||!i||!["own"].includes(i),iconSize:"100%",type:"onlyIcon",onClick:function(){t.openModal({Modal:h.n.FormCreateCompany,modalChildrenProps:{fillHeight:!0,title:"\u0420\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u0442\u0438 \u043a\u043e\u043c\u043f\u0430\u043d\u0456\u044e"}})}}},T=function(e){var n,o=e.companyType,i=e.ctx;return{name:"deleteCompany",title:"\u0412\u0438\u0434\u0430\u043b\u0438\u0442\u0438",icon:"delete",iconSize:"100%",disabled:!(null===(n=i.selectedRow)||void 0===n||!n._id||!o)&&["own"].includes(o),type:"onlyIcon",onClick:function(){var e;console.log("selPermission",null===(e=i.selectedRow)||void 0===e?void 0:e._id)}}},Z=function(e){var n,o=e.companyType,i=e.ctx;return{name:"leaveCompany",title:"\u041f\u043e\u043a\u0438\u043d\u0443\u0442\u0438",icon:"logOut",iconSize:"100%",disabled:null===(n=i.selectedRow)||void 0===n||!n._id||!o||!["invited"].includes(o),type:"onlyIcon",onClick:function(){var e;console.log("leaveCompany",null===(e=i.selectedRow)||void 0===e?void 0:e._id)}}},b=function(e){var n,o=e.ctx,i=e.companyType;return{name:"rejectPermission",title:"\u0412\u0456\u0434\u0445\u0438\u043b\u0438\u0442\u0438",icon:"clear",iconSize:"100%",type:"onlyIconFilled",disabled:null===(n=o.selectedRow)||void 0===n||!n._id||!i||!["invites"].includes(i),onClick:function(){console.log("rejectPermission",o.selectedRow)}}},P=function(e){var n,o=e.ctx,i=e.companyType;return{name:"acceptPermission",title:"\u041f\u0440\u0438\u0439\u043d\u044f\u0442\u0438",icon:"done",iconSize:"100%",type:"onlyIconFilled",disabled:null===(n=o.selectedRow)||void 0===n||!n._id||!i||!["invites"].includes(i),onClick:function(){console.log("acceptPermission",o.selectedRow)}}},R=function(e){var n=e.modalService;return{name:"createCompany",title:"\u0421\u0442\u0432\u043e\u0440\u0438\u0442\u0438 \u043a\u043e\u043c\u043f\u0430\u043d\u0456\u044e",icon:"plus",iconSize:"100%",type:"onlyIconFilled",onClick:function(){n.openModal({Modal:h.n.FormCreateCompany,props:{fillHeight:!0,title:"\u0421\u0442\u0432\u043e\u0440\u0438\u0442\u0438 \u043a\u043e\u043c\u043f\u0430\u043d\u0456\u044e"}})}}},j=new w.S7;j.add("refresh",(function(e){var n=e.ctx,o=e.service,i=e.extra;return{name:"refresh",title:(0,C.t)("Refresh"),icon:"refresh",iconSize:"100%",type:"onlyIcon",disabled:!(null!==i&&void 0!==i&&i.userId),onClick:function(){null!==i&&void 0!==i&&i.userId&&o.getAllByUserId({onLoading:n.onRefresh,data:{userId:null===i||void 0===i?void 0:i.userId,query:null===i||void 0===i?void 0:i.query}})}}}));var z,F,q,B=function(e){var n,o,i=(0,g.xc)()[x.d.permissions],t=(0,f.kw)(),l=null===(n=(0,v.DF)())||void 0===n||null===(o=n.user)||void 0===o?void 0:o._id,r=(0,_.x)(),c=(0,y.s0)();return function(n){var o={ctx:n,navigate:c,service:i,modalService:t,companyType:e,router:r},a=j.activate({navigate:c,service:i,modalService:t,extra:{userId:l,query:{type:e}}});return[S(o),Z(o),{separator:!0}].concat((0,m.Z)(a(n)),[{separator:!0},k(o),T(o),{separator:!0},b(o),P(o),R(o)])}},D=o(9214),E=o(6767),M=o(457),U=o(1500),A=o(2989),H=o(9953),L=o(8095),N=o(9751),O=o(3329),V=["query"],G=(0,U.H1)(N.T8),W=function(e){e.path;var n=(0,v.DF)().user,o=(0,A.xj)(),i=o.query,s=(0,c.Z)(o,V),u=(0,p.O)(),m=(0,g.xc)()[x.d.permissions],f=B(i.companyType||N.T8.own),y=(0,d.useState)(!1),h=(0,r.Z)(y,2),w=h[0],C=h[1],I=(0,d.useMemo)((function(){var e,n=i.companyType||N.T8.own,o=(0,l.Z)({},n,!0),t=null===(e=u.permissions)||void 0===e?void 0:e.filter((function(e){var n,i;return o.invited?e.status===D.nx.ACCEPTED:o.invites?e.status===D.nx.PENDING:o.all?e:o.own?(null===(n=e.user)||void 0===n?void 0:n._id)===(null===(i=e.owner)||void 0===i?void 0:i._id):e}));return{companyTypeIs:o,data:t}}),[i.companyType,u.permissions]),_=I.data,S=(0,d.useMemo)((function(){return{tableData:_,tableTitles:E.Tz,searchParams:M.rB,sortParams:M.UD,hasFilter:!1,showFooter:!0,hasSearch:!0,checkBoxes:!1,actionsCreator:f}}),[f,_]);return(0,d.useEffect)((function(){s.push({query:{companyType:G[0].value}})}),[]),(0,d.useEffect)((function(){n&&n._id&&m.getAllByUserId({data:{userId:n._id},onLoading:C})}),[null===n||void 0===n?void 0:n._id]),(0,O.jsxs)(J,{children:[(0,O.jsx)(K,{children:(0,O.jsx)(H.Z,{options:G,onSelect:function(e){s.push({query:{companyType:e.value}})}})}),(0,O.jsx)(Q,{children:(0,O.jsx)(a.ZP,(0,t.Z)((0,t.Z)({},S),{},{isLoading:w}))})]})},J=s.ZP.div(z||(z=(0,i.Z)(["\n  display: grid;\n  grid-template-columns: 1fr;\n  grid-template-rows: min-content 1fr;\n\n  ","\n"])),u.VU),K=s.ZP.div(F||(F=(0,i.Z)(["\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n\n  position: relative;\n\n  overflow: hidden;\n\n  //background-color: ",";\n\n  ","\n"])),(function(e){return e.theme.tableBackgroundColor}),u.SI),Q=(0,s.ZP)(L.ZP)(q||(q=(0,i.Z)(["\n  align-items: center;\n  justify-content: center;\n\n  overflow: hidden;\n  padding: 8px 0 16px;\n\n  ",";\n\n  background-color: ",";\n"])),u.SI,(function(e){return e.theme.tableBackgroundColor})),X=(0,d.memo)(W)},6616:function(e,n,o){o.r(n);var i=o(6931),t=o(6433),l=o(2791),r=o(3329),c=function(e){var n=e.path;return(0,r.jsx)(i.default,{path:n,children:(0,r.jsx)(t.default,{})})};n.default=(0,l.memo)(c)},8495:function(e,n,o){o.d(n,{SI:function(){return d},VU:function(){return a}});var i,t,l,r=o(168),c=o(3350),a=(0,c.iv)(i||(i=(0,r.Z)(["\n  grid-column: 1/13;\n  grid-row: 1/13;\n"]))),d=(0,c.iv)(t||(t=(0,r.Z)(["\n  width: 100%;\n  height: 100%;\n"])));(0,c.iv)(l||(l=(0,r.Z)(["\n  outline: 1px solid tomato;\n"])))}}]);
//# sourceMappingURL=616.0e30d6aa.chunk.js.map