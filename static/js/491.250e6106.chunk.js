"use strict";(self.webpackChunkmia_erp=self.webpackChunkmia_erp||[]).push([[491],{491:function(e,n,i){i.r(n),i.d(n,{FormCreateOrdersGroupStepsEnum:function(){return ze},default:function(){return He}});var o,t,r,l,a,d,u,s,c=i(168),v=i(1413),f=i(9439),h=i(4942),m=i(7049),p=i(9953),x=i(2791),g=i(3350),Z=i(8095),b=i(1251),j=i(3544),C=i(4662),P=i(3433),S=i(7348),y=i(2928),w=i(1383),I=i(3185),k=i(3665),D=i(6606),B=i(763),q=i.n(B),W=i(3329),E=(0,g.ZP)(Z.ZP)(o||(o=(0,c.Z)(["\n  //position: relative;\n  min-height: 32px;\n  //height: max-content;\n  max-height: 32px;\n  //overflow: hidden;\n\n  color: inherit;\n\n  border-top: 1px solid ",";\n  transition: all ",";\n  &:last-child {\n    border-bottom: 1px solid ",";\n  }\n"])),(function(e){return e.theme.trBorderClr}),(function(e){return e.theme.globals.timingFnMain}),(function(e){return e.theme.trBorderClr})),M=(0,g.ZP)(Z.ZP)(t||(t=(0,c.Z)(["\n  min-height: 32px;\n\n  position: sticky;\n  top: 0;\n  left: 0;\n  z-index: 50;\n\n  color: inherit;\n  border-bottom: 1px solid ",";\n  background-color: ",";\n"])),(function(e){return e.theme.trBorderClr}),(function(e){return e.theme.modalBackgroundColor})),A=(0,g.ZP)(Z.ZP)(r||(r=(0,c.Z)(["\n  height: max-content;\n\n  transition: all ",";\n"])),(function(e){return e.theme.globals.timingFnMain})),_=(0,g.ZP)(y.ZP)(l||(l=(0,c.Z)(["\n  justify-content: flex-start;\n\n  padding: 0 8px 0 0;\n\n  min-width: min-content;\n\n  flex: 1;\n\n  font-size: 14px;\n  font-weight: 500;\n  color: inherit;\n\n  fill: ",";\n\n  &:hover,\n  &:active,\n  &:focus {\n    background-color: inherit;\n  }\n"])),(function(e){return e.theme.accentColor.base})),R=function(e){var n=e.children,i=e.maxHeight,o=void 0===i?"32px":i,t=e.renderHeader,r=e.renderFooter,l=e.toggled,a=void 0===l||l,d=e.open,u=void 0!==d&&d,s=e.disabled,c=e.contentContainerStyle,h=e.activeBackgroundColor,m=void 0===h?"rgba(220, 220, 220, 1)":h,p=e.className,g=(0,x.useState)(!!s||u),Z=(0,f.Z)(g,2),b=Z[0],C=Z[1];return(0,x.useEffect)((function(){(0,B.isBoolean)(s)&&s&&C(!1)}),[s]),(0,W.jsxs)(E,{style:{maxHeight:b?"100%":o},className:p,children:[(0,W.jsxs)(M,{fillWidth:!0,fxDirection:"row",className:"header",isOpen:b,alignItems:"center",justifyContent:"space-between",activeBackgroundColor:m,children:[(0,W.jsx)(_,{icon:a?b?"SmallArrowDown":"SmallArrowRight":void 0,iconSize:"24px",variant:"def",onClick:function(){a&&C((function(e){return!e}))},disabled:!a||s||!n,isOpen:b,children:b?(0,j.t)("Close"):(0,j.t)("Open")}),t]}),(0,W.jsx)(A,(0,v.Z)((0,v.Z)({padding:"0 8px",overflow:"hidden"},c),{},{className:"content",children:n})),r]})},z=i(6492),F=(0,g.ZP)(R)(a||(a=(0,c.Z)(["\n  & .header {\n  }\n  & .content {\n    padding: 0;\n  }\n"]))),N=function(e){var n=e.slots,i=e.onRemove,o=e.onUpdate,t=e.renderHeader,r=e.title,l=e.onAddSlotPress,a=e.renderFooter,d=(0,g.Fg)(),u=(0,x.useMemo)((function(){return n.map((function(e){return(0,W.jsx)(D.Z,{slot:e,editable:!0,onRemovePress:i?function(){return(null===e||void 0===e?void 0:e.tempId)&&i(null===e||void 0===e?void 0:e.tempId)}:void 0,onUpdate:o},"slot_".concat(null===e||void 0===e?void 0:e.tempId))}))}),[i,o,n]),s=(0,x.useMemo)((function(){return(0,W.jsxs)(Z.ZP,{fxDirection:"row",fillHeight:!0,gap:8,alignItems:"center",padding:"2px 0",children:[t||(0,W.jsx)(z.x,{$weight:500,$size:15,children:r}),l&&(0,W.jsx)(Z.ZP,{height:"80%",border:"1px solid ".concat(d.modalBorderColor)}),l&&(0,W.jsx)(y.ZP,{variant:"textExtraSmall",style:{minWidth:"fit-content",height:"100%",fontWeight:600},disabled:!l,onClick:l,children:(0,j.t)("Add")})]})}),[l,t,d.modalBorderColor,r]);return(0,W.jsx)(W.Fragment,{children:(0,W.jsx)(F,{open:!0,renderHeader:s,renderFooter:a,title:r,children:u})})},$=i(387),T=i(4805),V=i(1819),H=i(7824),L=(0,g.ZP)(Z.ZP)(d||(d=(0,c.Z)(["\n  color: ",";\n"])),(function(e){return e.theme.fontColorSidebar})),O=(0,g.ZP)(Z.ZP)(u||(u=(0,c.Z)([""]))),G=(0,g.ZP)(Z.ZP)(s||(s=(0,c.Z)(["\n  border-top: 1px solid ",";\n  border-bottom: 1px solid ",";\n"])),(function(e){return e.theme.modalBorderColor}),(function(e){return e.theme.modalBorderColor})),U=function(e){var n=e.onChangeValidStatus,i=(0,k.kw)(),o=(0,V.xc)()[H.d.orders],t=(0,S.xA)().ordersGroupFormData.slots,r=(0,T.useMediaQuery)({maxWidth:480}),l=(0,x.useCallback)((function(e){o.addTempSlot(e)}),[o]),a=(0,x.useCallback)((function(e){o.removeTempSlot(e)}),[o]),d=(0,x.useCallback)((function(e){o.updateTempSlot(e)}),[o]),u=(0,x.useMemo)((function(){var e={};return null===t||void 0===t||t.map((function(n){var i,o,t;null!==(i=n.warehouse)&&void 0!==i&&i._id&&(e[n.warehouse._id]={warehouse:n.warehouse,slots:null!==(o=e[n.warehouse._id])&&void 0!==o&&o.slots?[].concat((0,P.Z)(null===(t=e[n.warehouse._id])||void 0===t?void 0:t.slots),[n]):[n]});return""})),e}),[t]);(0,x.useEffect)((function(){n&&n(!(null===t||void 0===t||!t.length)&&(null===t||void 0===t?void 0:t.length)>0)}),[n,null===t||void 0===t?void 0:t.length]);var s=(0,x.useMemo)((function(){return Object.keys(u).map((function(e,n){var o,t,r=u[e];return(0,W.jsx)(N,{slots:r.slots,title:null===r||void 0===r||null===(t=r.warehouse)||void 0===t?void 0:t.label,onRemove:a,onUpdate:d,onAddSlotPress:function(){var e=i.open({Modal:I.n.FormCreateOrderSlot,props:{params:null!==r&&void 0!==r&&r.warehouse?{warehouse:(0,$.rE)(null===r||void 0===r?void 0:r.warehouse)}:void 0,onSubmit:function(n){l(n),n&&null!==e&&void 0!==e&&e.onClose&&(null===e||void 0===e||e.onClose())}}})}},"pre-order_".concat((null===(o=r.warehouse)||void 0===o?void 0:o._id)||n))}))}),[u,l,a,d,i]);return(0,W.jsxs)(L,{flex:1,fillWidth:!0,overflow:"hidden",style:{position:"relative"},children:[(0,W.jsx)(O,{flex:1,overflow:"auto",children:(0,W.jsx)(Z.ZP,{flex:1,fillWidth:!0,children:s})}),(0,W.jsxs)(G,{fxDirection:"row",gap:8,padding:"8px",children:[(0,W.jsx)(y.ZP,{variant:"defaultSmall",onClick:function(){window.confirm("Remove all items?")&&w.kl.info("All items will be remove")},children:(0,j.t)("Remove all")}),(0,W.jsx)(y.ZP,{variant:"outlinedSmall",flex:1,onClick:function(){var e=i.open({Modal:I.n.FormCreateOrderSlot,props:{onSubmit:function(n){l(n),n&&null!==e&&void 0!==e&&e.onClose&&(null===e||void 0===e||e.onClose())}}})},children:(0,j.t)(r?"Add":"Add position to group")})]})]})},Q=i(4990),J=i(4925),X=i(9656),K=i(1186),Y=i(8589),ee=i(7665),ne=["onSelect","onSubmit","onClose","asReceiver"],ie=function(e){var n=e.onSelect,i=(e.onSubmit,e.onClose),o=e.asReceiver,t=(0,J.Z)(e,ne),r=(0,S.I6)().customers,l=(0,k.kw)(),a=(0,V.xc)()[V.EJ.customers],d=(0,x.useMemo)((function(){return{tableData:r,tableTitles:K.f,actionsCreator:function(e){return[{icon:"refresh",onClick:function(){return a.getAll()}},{separator:!0},{icon:"plus",onClick:function(){var e=l.open({ModalChildren:ee.Z,modalChildrenProps:{onSubmit:function(n){a.create({data:(0,$.vg)(n),onSuccess:null===e||void 0===e?void 0:e.onClose})}}})}}]},onRowClick:function(e){null!==e&&void 0!==e&&e.rowData&&n&&(n(e.rowData),i&&i())}}}),[a,r,i,l,n]);return(0,x.useEffect)((function(){a.getAll({data:{refresh:!0,params:{}}})}),[]),(0,W.jsx)(X.Z,(0,v.Z)((0,v.Z)({fillWidth:!0,fillHeight:!0,title:(0,j.t)(o?"Select receiver":"Select customer"),onClose:i},t),{},{children:(0,W.jsx)(Y.ZP,(0,v.Z)({},d))}))},oe=i(7802),te=i(9214),re=i(7666),le=["onSubmit","onSelect","onClose"],ae=function(e){e.onSubmit;var n,i=e.onSelect,o=e.onClose,t=((0,J.Z)(e,le),(0,S.O5)()),r=t.users,l=t.permission,a=(0,V.xc)()[H.d.permissions],d=(0,x.useState)(!1),u=(0,f.Z)(d,1)[0],s=(0,x.useMemo)((function(){return{tableData:r.filter((function(e){return!e.integration})),onRowClick:function(e){var n=r.find((function(n){return n._id===(null===e||void 0===e?void 0:e.rowId)}));n&&i&&i(n)},actionsCreator:function(e){return[{name:"refresh",icon:"refresh",onClick:function(){var e,n;(null===(e=l.company)||void 0===e?void 0:e._id)&&a.getAllByCompanyId({data:{_id:null===(n=l.company)||void 0===n?void 0:n._id,params:{recipient:te.E.user}}})}}]}}}),[i,null===(n=l.company)||void 0===n?void 0:n._id,a,r]);return(0,W.jsx)(X.Z,{fillWidth:!0,fillHeight:!0,onClose:o,title:(0,j.t)("Select manager"),children:(0,W.jsx)(Y.ZP,(0,v.Z)((0,v.Z)({tableTitles:re.NT},s),{},{hasSearch:!1,isLoading:u}))})},de=i(1392),ue=i(2911),se=i(389),ce=i(6681),ve=i(1134),fe=function(e){var n=e.onSuccess,i=e.isReceiver,o=(0,V.xc)()[V.EJ.customers],t=(0,k.kw)();return(0,W.jsx)(y.ZP,{variant:"onlyIcon",icon:"plus",iconSize:"100%",size:"30px",onClick:function(){var e=t.open({ModalChildren:ee.Z,modalChildrenProps:{title:i?(0,j.t)("Create receiver"):void 0,onSubmit:function(i){o.create({data:(0,$.vg)(i),onSuccess:function(i){n&&n(i),null===e||void 0===e||e.onClose()}})}}})}})},he=function(e){var n=e.info,i=e.isReceiver,o=e.isManager,t=(0,g.Fg)(),r=(0,x.useMemo)((function(){if(n)return function(e){var n=e.isManager;return[{label:(0,j.t)("label"),getValue:function(e){var n;return(null===e||void 0===e||null===(n=e.label)||void 0===n?void 0:n.base)||"---"},visible:!n},{label:(0,j.t)("name"),getValue:function(e){var n;return(null===e||void 0===e||null===(n=e.name)||void 0===n?void 0:n.first)||"---"},visible:!0},{label:(0,j.t)("Middle name"),getValue:function(e){var n;return(null===e||void 0===e||null===(n=e.name)||void 0===n?void 0:n.middle)||"---"},visible:!0},{label:(0,j.t)("secondName"),getValue:function(e){var n;return(null===e||void 0===e||null===(n=e.name)||void 0===n?void 0:n.second)||"---"},visible:!0},{label:(0,j.t)("email"),getValue:function(e){return(null===e||void 0===e?void 0:e.email)||"---"},visible:!0},{label:(0,j.t)("taxCode"),getValue:function(e){var n;return(null===e||void 0===e||null===(n=e.taxCode)||void 0===n?void 0:n.corp)||"---"},visible:!n},{label:(0,j.t)("personalTaxCode"),getValue:function(e){var n;return(null===e||void 0===e||null===(n=e.taxCode)||void 0===n?void 0:n.personal)||"---"},visible:!n},{label:(0,j.t)("tags"),getValue:function(e){var n;return(null===e||void 0===e||null===(n=e.tags)||void 0===n?void 0:n.join(", "))||"---"},visible:!n}]}({info:warehouse,isReceiver:i,isManager:o}).map((function(e){var i=e.label,o=e.getValue;return e.visible&&(0,W.jsxs)(Z.ZP,{gap:2,padding:"4px",flex:"1 1 50%",maxWidth:"50%",border:"1px solid ".concat(t.modalBorderColor),children:[(0,W.jsx)(z.x,{$size:10,children:i}),(0,W.jsx)(z.x,{$align:"right",$size:12,$weight:600,children:o(n)})]},i)}))}),[n,o,i,t.modalBorderColor]);return(0,W.jsx)(Z.ZP,{fillWidth:!0,flexWrap:"wrap",fxDirection:"row",border:"1px solid ".concat(t.modalBorderColor),children:r})};var me=[{name:"country",label:(0,j.t)("Country"),required:!1},{name:"region",label:(0,j.t)("Region"),required:!1},{name:"area",label:(0,j.t)("Area"),required:!1},{name:"city",label:(0,j.t)("City"),required:!1},{name:"street",label:(0,j.t)("Street"),required:!1},{name:"house",label:(0,j.t)("House"),required:!1},{name:"office",label:(0,j.t)("Office"),required:!1},{name:"room",label:(0,j.t)("Room"),required:!1}],pe=(q().throttle((function(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];(e=console).log.apply(e,["Throttled Logger"].concat(i))}),5e3),q().throttle((function(e){console.log(pe.name),e()}),3e3)),xe=i(1604),ge=i(9297),Ze=i(8527),be=i(4522);function je(e,n){(0,be.Z)(2,arguments);var i=(0,Ze.Z)(e),o=(0,ge.Z)(n);return isNaN(o)?new Date(NaN):o?(i.setDate(i.getDate()+o),i):i}var Ce,Pe,Se,ye,we,Ie,ke,De=i(8251),Be=function(e){var n=e.title;return(0,W.jsx)(z.x,{$padding:"0 6px",$ellipsisMode:!0,$size:16,$weight:500,children:n})},qe=(0,g.ZP)(Z.ZP)(Ce||(Ce=(0,c.Z)([""]))),We=(0,g.ZP)(Z.ZP)(Pe||(Pe=(0,c.Z)(["\n  padding-bottom: 8px;\n\n  border-top: 1px solid ",";\n  border-bottom: 1px solid ",";\n"])),(function(e){return e.theme.modalBorderColor}),(function(e){return e.theme.modalBorderColor})),Ee=(0,g.ZP)(R)(Se||(Se=(0,c.Z)(["\n  & .content {\n    max-width: 480px;\n    width: 100%;\n    margin: auto;\n  }\n"]))),Me=function(e){var n,i,o,t,r,l,a,d,u,s,c,p,g=e.onChangeValidStatus,b=(0,k.kw)(),C=(0,ve.Gc)(),P=C.formState,w=P.isValid,I=P.errors,D=C.register,B=C.setValue,q=C.unregister,E=C.watch,M=C.trigger,A=(0,x.useState)(De.oZ.externalService),_=(0,f.Z)(A,2),R=(_[0],_[1],E()),z=(0,ue.f)((0,S.ei)().methods,{withFullLabel:!0}),F=(0,ue.f)((0,S.$N)().methods,{withFullLabel:!0}),N=(0,ue.f)((0,S.A2)().methods,{withFullLabel:!0}),$=(0,x.useState)({hasDelivery:!!R.deliveryInfo,hasDeliveryInvoice:!(null===(n=R.deliveryInfo)||void 0===n||!n.invoiceInfo),hasReceiverInfo:!!R.receiver,hasExecuteDate:!(null===(i=R.shipmentInfo)||void 0===i||!i.executeAt)}),T=(0,f.Z)($,2),V=T[0],H=T[1],L=function(e,n){try{B(e,n,{shouldTouch:!0}),pe((function(){return M().then((function(e){e&&g&&g(e)})).catch((function(e){console.error("handleOnChangeValue trigger error",e)}))}))}catch(i){console.error("handleOnChangeValue: ",i)}},O=function(e){return function(n){if(H((function(i){return(0,v.Z)((0,v.Z)({},i),{},(0,h.Z)({},e,n))})),n){if("hasExecuteDate"===e)return B("shipmentInfo.executeAt",xe.Z(je(new Date,1),"yyyy-MM-dd"));if("hasDeliveryInvoice"===e)return B("deliveryInfo.invoiceInfo.expireAt",(0,m.w4)(je(new Date,1)))}else if(!n){if("hasReceiverInfo"===e)return q("receiver");if("hasDeliveryInvoice"===e)return q("deliveryInfo.invoiceInfo");if("hasDelivery"===e)return q("deliveryInfo")}}},G=function(e){return{name:e,onChange:O(e),value:V[e]}};return(0,x.useEffect)((function(){g&&g(w)}),[w,g]),(0,W.jsxs)(qe,{flex:1,overflow:"auto",children:[(0,W.jsxs)(Z.ZP,{fillWidth:!0,gap:8,padding:"8px 2px",style:{maxWidth:480,width:"100%",margin:"0 auto"},children:[(null===R||void 0===R?void 0:R.manager)&&(0,W.jsx)(Q.Z,{label:(0,j.t)("Manager"),children:(0,W.jsx)(he,{info:null===R||void 0===R||null===(o=R.manager)||void 0===o?void 0:o.user,isManager:!0})}),(0,W.jsx)(y.ZP,{variant:"outlinedSmall",onClick:function(){var e=b.open({ModalChildren:ae,modalChildrenProps:{onSelect:function(n){L("manager",n),(null===e||void 0===e?void 0:e.onClose)&&(null===e||void 0===e||e.onClose())}}})},children:(0,j.t)(null!==R&&void 0!==R&&R.manager?"Change manager":"Select manager")})]}),(0,W.jsxs)(Z.ZP,{padding:"0 2px",children:[(0,W.jsxs)(Ee,{contentContainerStyle:{padding:"8px 0",gap:8},open:!0,renderHeader:(0,W.jsx)(Be,{title:(0,j.t)("Customer")}),children:[(null===R||void 0===R?void 0:R.customer)&&(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(Q.Z,{label:(0,j.t)("Customer information"),children:(0,W.jsx)(he,{info:null===R||void 0===R?void 0:R.customer})}),(0,W.jsx)(We,{fillWidth:!0,overflow:"hidden",children:(0,W.jsx)(Q.Z,{label:(0,j.t)("Communication methods"),children:(0,W.jsx)(oe.Z,{numColumns:2,value:[null!==(t=null===R||void 0===R||null===(r=R.communication)||void 0===r||null===(l=r.customer)||void 0===l?void 0:l._id)&&void 0!==t?t:""],resetButtonLabel:(0,j.t)("Not needed"),options:F,resetButtonPosition:"start",onSelect:function(e){var n=e.value;L("communication.customer",{_id:n})}})})})]}),(0,W.jsxs)(Z.ZP,{fxDirection:"row",gap:8,fillWidth:!0,alignItems:"center",children:[(0,W.jsx)(fe,{onSuccess:function(e){L("customer",e)}}),(0,W.jsx)(y.ZP,{variant:"outlinedSmall",flex:1,onClick:function(){var e=b.open({ModalChildren:ie,modalChildrenProps:{onSelect:function(n){L("customer",n),(null===e||void 0===e?void 0:e.onClose)&&(null===e||void 0===e||e.onClose())}}})},children:(0,j.t)(null!==R&&void 0!==R&&R.customer?"Change customer":"Select customer")})]}),(0,W.jsx)(We,{fillWidth:!0,gap:4,children:(0,W.jsx)(Q.Z,{label:(0,j.t)("Receiver"),children:(0,W.jsx)(se.Z,(0,v.Z)((0,v.Z)({},G("hasReceiverInfo")),{},{rejectLabel:(0,j.t)("The same"),acceptLabel:(0,j.t)("Another")}))})})]}),(null===V||void 0===V?void 0:V.hasReceiverInfo)&&(0,W.jsxs)(Ee,{contentContainerStyle:{padding:"8px 0",gap:8},open:!0,renderHeader:(0,W.jsx)(Be,{title:(0,j.t)("Receiver")}),children:[(null===R||void 0===R?void 0:R.receiver)&&(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)(Q.Z,{label:(0,j.t)("Receiver information"),children:[(0,W.jsx)(he,{info:null===R||void 0===R?void 0:R.receiver})," "]}),(0,W.jsx)(We,{fillWidth:!0,children:(0,W.jsx)(Q.Z,{label:(0,j.t)("Communication methods"),children:(0,W.jsx)(oe.Z,{numColumns:2,value:[null!==(a=null===R||void 0===R||null===(d=R.communication)||void 0===d||null===(u=d.receiver)||void 0===u?void 0:u._id)&&void 0!==a?a:""],resetButtonLabel:(0,j.t)("Without"),options:F.map((function(e){return(0,v.Z)((0,v.Z)({},e),{},{value:e._id})})),resetButtonPosition:"start",onSelect:function(e){var n=e.value;L("communication.receiver",{_id:n})}})})})]}),(0,W.jsxs)(Z.ZP,{fxDirection:"row",gap:8,fillWidth:!0,alignItems:"center",children:[(0,W.jsx)(fe,{isReceiver:!0,onSuccess:function(e){L("receiver",e)}}),(0,W.jsx)(y.ZP,{variant:"outlinedSmall",flex:1,onClick:function(){var e=b.open({ModalChildren:ie,modalChildrenProps:{onSelect:function(n){L("receiver",n),(null===e||void 0===e?void 0:e.onClose)&&(null===e||void 0===e||e.onClose())}}})},children:(0,j.t)(null!==R&&void 0!==R&&R.receiver?"Change receiver":"Select receiver")})]})]}),(0,W.jsxs)(Ee,{contentContainerStyle:{padding:"0 2px"},open:!0,renderHeader:(0,W.jsx)(Be,{title:(0,j.t)("Shipment")}),children:[(0,W.jsxs)(We,{fillWidth:!0,gap:4,children:[(0,W.jsx)(Q.Z,{label:(0,j.t)("Another execute date"),children:(0,W.jsx)(se.Z,(0,v.Z)({},G("hasExecuteDate")))}),(null===V||void 0===V?void 0:V.hasExecuteDate)&&(0,W.jsx)(Q.Z,{label:(0,j.t)("Execute at"),required:null===V||void 0===V?void 0:V.hasExecuteDate,children:(0,W.jsx)(ce.ZP,(0,v.Z)({placeholder:(0,j.t)("Execute at"),type:"date",required:null===V||void 0===V?void 0:V.hasExecuteDate},D("shipmentInfo.executeAt",{required:null===V||void 0===V?void 0:V.hasExecuteDate})))})]}),(0,W.jsx)(We,{fillWidth:!0,gap:4,children:(0,W.jsx)(Q.Z,{label:(0,j.t)("Delivery"),children:(0,W.jsx)(se.Z,(0,v.Z)({},G("hasDelivery")))})})]}),(null===V||void 0===V?void 0:V.hasDelivery)&&(0,W.jsxs)(Ee,{contentContainerStyle:{padding:"0 2px"},open:!0,renderHeader:(0,W.jsx)(Be,{title:(0,j.t)("Delivery")}),children:[(0,W.jsx)(We,{fillWidth:!0,gap:8,children:(0,W.jsx)(Q.Z,{label:(0,j.t)("Delivery method"),required:!0,children:(0,W.jsx)(de.Z,{options:z,currentOption:null===R||void 0===R||null===(s=R.deliveryInfo)||void 0===s?void 0:s.method,onChangeIndex:function(e){L("deliveryInfo.method",z[e])}})})}),(0,W.jsx)(We,{fillWidth:!0,style:{columnGap:8,display:"grid",gridTemplateColumns:"1fr 1fr"},children:me.map((function(e){var n,i,o=e.name,t=e.label,r=e.required;return(0,W.jsx)(Q.Z,{label:t,error:null!==I&&void 0!==I&&null!==(n=I.deliveryInfo)&&void 0!==n&&n.destination?null===I||void 0===I||null===(i=I.deliveryInfo)||void 0===i?void 0:i.destination[o]:void 0,required:r,children:(0,W.jsx)(ce.ZP,(0,v.Z)({required:r,placeholder:t},D("deliveryInfo.destination.".concat(o),{required:r})))},"dest-addr-".concat(t))}))}),(0,W.jsx)(We,{fillWidth:!0,gap:8,children:(0,W.jsx)(Q.Z,{label:(0,j.t)("Has payment"),required:!0,children:(0,W.jsx)(se.Z,(0,v.Z)({},G("hasDeliveryInvoice")))})}),(0,W.jsx)(We,{fillWidth:!0,gap:8,children:(null===V||void 0===V?void 0:V.hasDeliveryInvoice)&&(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(Q.Z,{label:(0,j.t)("Payment method"),required:!0,children:(0,W.jsx)(de.Z,{options:N,currentOption:null===R||void 0===R||null===(c=R.deliveryInfo)||void 0===c||null===(p=c.invoiceInfo)||void 0===p?void 0:p.method,onChangeIndex:function(e){L("deliveryInfo.invoiceInfo.method",N[e])}})}),(0,W.jsx)(Q.Z,{label:(0,j.t)("Expired at"),required:!0,children:(0,W.jsx)(ce.ZP,(0,v.Z)({placeholder:(0,j.t)("Expired at"),type:"datetime-local",required:!0},D("deliveryInfo.invoiceInfo.expireAt",{required:!0})))})]})})]}),(0,W.jsx)(Ee,{contentContainerStyle:{padding:"8px 2px"},open:!0,renderHeader:(0,W.jsx)(Be,{title:(0,j.t)("Invoicing")}),children:(0,W.jsx)(Q.Z,{label:(0,j.t)("Expired at"),required:!0,children:(0,W.jsx)(ce.ZP,(0,v.Z)({placeholder:(0,j.t)("Expired at"),type:"datetime-local",required:!0},D("invoiceInfo.expireAt",{required:!0})))})})]})]})},Ae=i(4695),_e=i(371),Re=i(2092),ze=function(e){return e.Stuffing="Stuffing",e.Info="Info",e}({}),Fe=(0,m.H1)(ze),Ne=(ye={},(0,h.Z)(ye,ze.Stuffing,!0),(0,h.Z)(ye,ze.Info,!1),ye),$e=g.ZP.form(we||(we=(0,c.Z)(["\n  color: ",";\n\n  display: flex;\n  flex-direction: column;\n\n  width: 98vw;\n  height: 98vh;\n  padding: 0 8px;\n\n  background-color: ",";\n"])),(function(e){return e.theme.fontColorSidebar}),(function(e){return e.theme.modalBackgroundColor})),Te=(0,g.ZP)(Z.ZP)(Ie||(Ie=(0,c.Z)(["\n  border-top: 1px solid ",";\n  border-bottom: 1px solid ",";\n"])),(function(e){return e.theme.modalBorderColor}),(function(e){return e.theme.modalBorderColor})),Ve=(0,g.ZP)(Z.ZP)(ke||(ke=(0,c.Z)([""]))),He=function(e){var n,i,o,t,r=e.onClose,l=(0,V.xc)()[V.EJ.orders],a=(0,S.xA)().ordersGroupFormData,d=(0,x.useState)(!1),u=(0,f.Z)(d,2),s=u[0],c=u[1],g=(0,m.dn)(Fe),Z=g.stepsMap,P=g.stepIdx,y=g.setNextStep,I=g.setPrevStep,k=g.getCurrentStep,D=g.isLast,B=(0,x.useState)(Ne),E=(0,f.Z)(B,2),M=E[0],A=E[1],_=function(e){return function(n){A((function(i){return(0,v.Z)((0,v.Z)({},i),{},(0,h.Z)({},ze[e],n))}))}},R=(0,ve.cI)({defaultValues:(0,v.Z)((0,v.Z)({},a.info),{},{invoiceInfo:(0,v.Z)((0,v.Z)({},null===(n=a.info)||void 0===n?void 0:n.invoiceInfo),{},{expireAt:null!==(i=null===(o=a.info)||void 0===o||null===(t=o.invoiceInfo)||void 0===t?void 0:t.expireAt)&&void 0!==i?i:(0,m.w4)(je(new Date,1))})}),resolver:(0,Ae.X)(_e.Lr),reValidateMode:"onSubmit"}),z=R.watch,F=R.handleSubmit,N=z(),$=(0,x.useMemo)((function(){return null!==Z&&void 0!==Z&&Z.Stuffing?(0,W.jsx)(U,{onChangeValidStatus:_("Stuffing")}):null!==Z&&void 0!==Z&&Z.Info?(0,W.jsx)(Me,{onChangeValidStatus:_("Info"),isGroup:!0}):void 0}),[null===Z||void 0===Z?void 0:Z.Info,null===Z||void 0===Z?void 0:Z.Stuffing]),T=(0,x.useMemo)((function(){return M[k().value]}),[k,M]);return(0,W.jsx)(ve.RV,(0,v.Z)((0,v.Z)({},R),{},{children:(0,W.jsxs)($e,{onSubmit:F((function(e){D?(0,Re.k_)(Re.p6.groups.createGroupedByWarehouse,{data:{info:l.toOrderInfoReqData(N,{omitPathArr:[]}),slots:l.toOrderSlotsReqData(a.slots)},onLoading:c,logError:!0,logResData:!0}):w.kl.error("Form data is not valid")}),(function e(n){console.log(e.name,n)})),children:[(0,W.jsx)(b.xB,{title:(0,j.t)("Create orders group by warehouse"),onBackPress:r}),(0,W.jsxs)(Te,{fillWidth:!0,flex:1,overflow:"hidden",children:[(0,W.jsx)(p.Z,{options:Fe,asStepper:!0,currentIndex:P,optionProps:{fitContentH:!0}}),$]}),(0,W.jsx)(Ve,{padding:"8px",children:(0,W.jsx)(C.Z,{steps:Fe,onNextPress:function(){"Info"===k().value&&l.updateCurrentGroupFormInfoData(q().cloneDeep(N)),T?y():w.kl.error("".concat((0,j.t)("Step is not finished"),': "').concat(k().value.toUpperCase(),'"'))},onPrevPress:function(){"Info"===k().value&&l.updateCurrentGroupFormInfoData(q().cloneDeep(N)),I()},currentIndex:P,canGoNext:!0,canSubmit:D,submitButton:!0,isLoading:s,onCancelPress:0===P?r:void 0})})]})}))}},7665:function(e,n,i){i.d(n,{Z:function(){return E}});var o,t=i(168),r=i(1413),l=i(4925),a=function(e){return e.facebook="facebook",e.instagram="instagram",e.referralSystem="referralSystem",e.another="another",e}({}),d=i(9656),u=i(3544),s=i(3350),c=i(8095),v=i(4990),f=i(6681),h=i(9964),m=i(457),p=i(1134),x=i(2928),g=i(1392),Z=i(8553),b=i(2791),j=i(1383),C=i(5611),P=i(763),S=i.n(P),y=i(3329),w=["defaultState","withReferer","onSubmit"],I=["register","setValue","handleSubmit","watch"],k=j.E4.isDevMode(),D=(0,Z.H1)(a),B=(0,s.ZP)(c.ZP)(o||(o=(0,t.Z)([""]))),q=function(e){var n=e.form,i=[{name:"first",label:(0,u.t)("First name"),required:!0},{name:"second",label:(0,u.t)("Second name")},{name:"middle",label:(0,u.t)("Middle name")}];return(0,y.jsx)(y.Fragment,{children:i.map((function(e){var i=e.name,o=e.label,t=e.required;return(0,y.jsx)(v.Z,{label:o,required:t,children:(0,y.jsx)(f.ZP,(0,r.Z)((0,r.Z)({placeholder:o},n.register("name.".concat(i),{required:t})),{},{required:t}))},"name_".concat(i))}))})},W=function(e){var n=e.form,i=[{name:"base",label:(0,u.t)("Label"),required:!0},{name:"print",label:(0,u.t)("Print label")}];return(0,y.jsx)(y.Fragment,{children:i.map((function(e){var i=e.name,o=e.label,t=e.required;return(0,y.jsx)(v.Z,{label:o,required:t,children:(0,y.jsx)(f.ZP,(0,r.Z)((0,r.Z)({placeholder:o},n.register("label.".concat(i),{required:t})),{},{required:t}))},"name_".concat(i))}))})},E=function(e){var n=e.defaultState,i=e.withReferer,o=e.onSubmit,t=(0,l.Z)(e,w),s=(0,p.cI)({defaultValues:(0,r.Z)((0,r.Z)({},n),{},{businessType:C.GE.company})}),Z=s.register,j=s.setValue,P=s.handleSubmit,E=s.watch,M=(0,l.Z)(s,I),A=E(),_=(0,b.useMemo)((function(){return!(null===n||void 0===n||!n.email)}),[null===n||void 0===n?void 0:n.email]);return(0,y.jsx)(d.Z,(0,r.Z)((0,r.Z)({fillHeight:!0},t),{},{title:t.title?t.title:(0,u.t)("Create customer"),onSubmit:P((function(e){o&&o(S().omit(e,_?["engagementSource","email"]:["engagementSource"]))})),children:(0,y.jsxs)(B,{padding:"0 8px 8px",children:[(0,y.jsx)(v.Z,{label:(0,u.t)("type"),required:!0,children:(0,y.jsx)(h.Z,{options:m.Wk,onSelect:function(e){j("businessType",null===e||void 0===e?void 0:e.value)}})}),A.businessType!==C.GE.person&&(0,y.jsx)(W,{form:(0,r.Z)({register:Z,setValue:j,handleSubmit:P,watch:E},M)}),A.businessType!==C.GE.company&&(0,y.jsx)(q,{form:(0,r.Z)({register:Z,setValue:j,handleSubmit:P,watch:E},M)}),(0,y.jsx)(v.Z,{label:(0,u.t)("email"),disabled:_,required:!0,children:(0,y.jsx)(f.ZP,(0,r.Z)((0,r.Z)({placeholder:(0,u.t)("email"),type:"email"},Z("email",{required:!0})),{},{disabled:_,required:!0}))}),(0,y.jsx)(v.Z,{label:(0,u.t)("phone"),children:(0,y.jsx)(f.ZP,(0,r.Z)({placeholder:(0,u.t)("phone")},Z("phone")))}),A.businessType!==C.GE.company&&(0,y.jsx)(v.Z,{label:(0,u.t)("Birth date"),children:(0,y.jsx)(f.ZP,(0,r.Z)((0,r.Z)({placeholder:(0,u.t)("Birth date")},Z("birthDate")),{},{type:"datetime-local"}))}),i&&k&&(0,y.jsx)(v.Z,{label:(0,u.t)("Referrer id"),children:(0,y.jsx)(f.ZP,(0,r.Z)({placeholder:(0,u.t)("Referrer id")},Z("referrer._id")))}),(0,y.jsx)(v.Z,{label:(0,u.t)("Source"),children:(0,y.jsx)(g.Z,{disabled:!0,options:D,currentOption:{value:null===A||void 0===A?void 0:A.engagementSource},onChangeIndex:function(e){j("engagementSource",D[e].value)}})}),(null===A||void 0===A?void 0:A.engagementSource)===a.referralSystem&&(0,y.jsxs)(c.ZP,{gap:8,fillWidth:!0,children:[(0,y.jsx)(v.Z,{label:(0,u.t)("Referrer"),required:!0,children:(0,y.jsx)(f.ZP,{placeholder:(0,u.t)("Referrer"),type:"email",required:!0})}),(0,y.jsxs)(c.ZP,{fxDirection:"row",fillWidth:!0,gap:8,padding:"8px 0",children:[(0,y.jsx)(x.ZP,{variant:"defaultSmall",children:(0,u.t)("Clear referrer")}),(0,y.jsx)(x.ZP,{variant:"outlinedSmall",flex:1,children:(0,u.t)("Select referrer")})]})]})]})}))}},6606:function(e,n,i){i.d(n,{Z:function(){return M}});var o,t,r,l,a,d,u,s,c,v=i(168),f=i(9439),h=i(8095),m=i(3350),p=i(2928),x=i(2791),g=i(6492),Z=i(3544),b=i(6681),j=i(7049),C=i(3329),P=(0,m.ZP)(b.ZP)(o||(o=(0,v.Z)(["\n  flex: 1;\n  width: 100%;\n  height: 100%;\n\n  padding: 0 6px;\n  font-size: 16px;\n  font-weight: 500;\n\n  text-align: center;\n\n  //border: 0;\n  //color: inherit;\n  //background: transparent;\n  //text-align: center;\n  //font-family: inherit;\n  //font-size: inherit;\n  //font-weight: inherit;\n"]))),S=function(e){var n=e.value,i=void 0===n?0:n,o=e.onChangeValue,t=e.width,r=e.height,l=void 0===r?"18px":r,a=e.disabled,d=e.className,u=e.autoFocus,s=(0,x.useState)(null!==i&&void 0!==i?i:0),c=(0,f.Z)(s,2),v=c[0],m=c[1],g=(0,x.useRef)(null),Z=function(e){return function(){var n;o?o(v+e>0?v+e:v):m((function(n){return n+e?n+e:n})),null===(n=g.current)||void 0===n||n.focus()}};return(0,x.useEffect)((function(){j.sr.isNum(i)&&i>0&&m(i)}),[i]),(0,C.jsxs)(h.ZP,{fxDirection:"row",gap:4,width:t,alignItems:"center",height:"min-content",children:[(0,C.jsx)(p.ZP,{variant:"onlyIcon",size:l,icon:"minus",onClick:Z(-1)}),(0,C.jsx)(P,{value:v,disabled:a,className:d,ref:g,onChange:function(e){var n=e.target.value;isNaN(Number(n))||(o?o(Number(n)):m(Number(n)))},onSubmit:function(e){e.preventDefault()},autoFocus:u}),(0,C.jsx)(p.ZP,{variant:"onlyIcon",size:l,icon:"plus",onClick:Z(1)})]})},y=i(4990),w=(0,m.ZP)(h.ZP)(t||(t=(0,v.Z)(["\n  position: relative;\n  //height: fit-content;\n  padding: 4px;\n\n  //height: min-content;\n\n  //border-bottom: 2px solid ",";\n  color: ",";\n  cursor: default;\n\n  border: 1px solid ",";\n  border-left: 3px solid ",";\n\n  transition: all ",";\n\n  &:hover {\n    border-color: ",";\n  }\n"])),(function(e){return e.theme.fieldBackgroundColor}),(function(e){return e.theme.fontColorSidebar}),(function(e){return e.theme.modalBorderColor}),(function(e){return e.theme.modalBorderColor}),(function(e){return e.theme.globals.timingFunctionMain}),(function(e){var n=e.disabled,i=e.theme;return!n&&i.accentColor.base})),I=(0,m.ZP)(h.ZP)(r||(r=(0,v.Z)(["\n  width: min-content;\n  @media screen and (min-width: 768px) {\n    width: max-content;\n    flex-direction: row;\n    gap: 8px;\n  }\n"]))),k=(0,m.ZP)(h.ZP)(l||(l=(0,v.Z)(["\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(110px, 1fr));\n  //grid-template-rows: repeat(5, min-content);\n  //grid-template-areas:\n  //  'label label label label sku sku'\n  //  'price bonus discount bonus cashback total';\n  //'category category brand brand type type'\n  //'atr_1 atr_1  atr_2  atr_2 qty qty'\n  //'warehouse warehouse warehouse warehouse warehouse warehouse';\n\n  //max-width: 270px;\n  height: max-content;\n  border-top: 1px solid ",";\n  border-bottom: 1px solid ",";\n"])),(function(e){return e.theme.modalBorderColor}),(function(e){return e.theme.modalBorderColor})),D=(0,m.ZP)(k)(a||(a=(0,v.Z)(["\n  grid-template-columns: repeat(auto-fill, minmax(125px, 1fr));\n"]))),B=(0,m.ZP)(h.ZP)(d||(d=(0,v.Z)(["\n  //height: fit-content;\n\n  //width: 100%;\n  object-position: center;\n  object-fit: contain;\n  overflow: hidden;\n  width: 100%;\n  max-width: 125px;\n  //max-height: 100px;\n  //height: 100px;\n\n  //@media screen and (max-width: 480px) {\n  //  width: 100px;\n  //  margin: auto;\n  //}\n"]))),q=(0,m.ZP)(g.x)(u||(u=(0,v.Z)(["\n  color: ",";\n"])),(function(e){var n=e.theme;return"secondary"===e.colorType?n.globals.inputPlaceholderColor:n.fontColorSidebar})),W=(0,m.ZP)(p.ZP)(s||(s=(0,v.Z)(["\n  padding: 6px 10px;\n"]))),E=(0,m.ZP)(h.ZP)(c||(c=(0,v.Z)(["\n  //border-top: 1px solid ",";\n"])),(function(e){return e.theme.modalBorderColor})),M=function(e){var n,i,o,t,r,l,a,d,u,s,c,v=e.slot,p=e.onEditPress,b=e.disabled,P=e.onSelectPress,M=e.onRemovePress,_=(e.onUpdate,e.editable),R=(0,x.useState)(v),z=(0,f.Z)(R,1)[0],F=(0,x.useMemo)((function(){var e,n,i,o,t,r,l,a,d,u,s,c,v,f,h,m,p,x,g,Z=[];null!==z&&void 0!==z&&null!==(e=z.product)&&void 0!==e&&null!==(n=e.images)&&void 0!==n&&n.length&&(Z=null===z||void 0===z||null===(v=z.product)||void 0===v?void 0:v.images);null!==z&&void 0!==z&&null!==(i=z.variation)&&void 0!==i&&null!==(o=i.offer)&&void 0!==o&&null!==(t=o.images)&&void 0!==t&&t.length&&(Z=null===z||void 0===z||null===(f=z.variation)||void 0===f||null===(h=f.offer)||void 0===h?void 0:h.images);null!==z&&void 0!==z&&null!==(r=z.inventory)&&void 0!==r&&null!==(l=r.offer)&&void 0!==l&&null!==(a=l.images)&&void 0!==a&&a.length&&(Z=null===z||void 0===z||null===(m=z.inventory)||void 0===m||null===(p=m.offer)||void 0===p?void 0:p.images);null!==z&&void 0!==z&&null!==(d=z.origin)&&void 0!==d&&null!==(u=d.offer)&&void 0!==u&&null!==(s=u.images)&&void 0!==s&&s.length&&(Z=null===z||void 0===z||null===(x=z.origin)||void 0===x||null===(g=x.offer)||void 0===g?void 0:g.images);return(null===(c=Z[0])||void 0===c?void 0:c.img_preview)||""}),[null===z||void 0===z||null===(n=z.product)||void 0===n?void 0:n.images,null===z||void 0===z||null===(i=z.variation)||void 0===i||null===(o=i.offer)||void 0===o?void 0:o.images,null===z||void 0===z||null===(t=z.origin)||void 0===t||null===(r=t.offer)||void 0===r?void 0:r.images,null===z||void 0===z||null===(l=z.inventory)||void 0===l||null===(a=l.offer)||void 0===a?void 0:a.images]),N=(0,x.useMemo)((function(){return A.map((function(e){var n=z&&e.name&&z[e.name],i=n&&"object"===typeof n&&"amount"in n?n.amount:n;return(0,C.jsxs)(h.ZP,{justifyContent:"flex-start",fillWidth:!0,padding:"4px",gap:4,children:[(0,C.jsx)(q,{colorType:"secondary",$size:10,children:e.label}),(0,C.jsx)(q,{$size:12,$align:"right",$weight:500,children:(0,j.__)(i||0)})]},e.name)}))}),[z]),$=(0,x.useMemo)((function(){var e,n;return null===v||void 0===v||null===(e=v.variation)||void 0===e||null===(n=e.properties)||void 0===n?void 0:n.map((function(e){var n;return(0,C.jsxs)(h.ZP,{justifyContent:"flex-start",fillWidth:!0,padding:"4px",gap:4,children:[(0,C.jsx)(q,{colorType:"secondary",$size:10,children:null===e||void 0===e||null===(n=e.parent)||void 0===n?void 0:n.label}),(0,C.jsx)(g.x,{$size:12,$align:"right",$weight:500,children:null===e||void 0===e?void 0:e.label})]},null===e||void 0===e?void 0:e._id)}))}),[null===v||void 0===v||null===(d=v.variation)||void 0===d?void 0:d.properties]),T=(0,m.Fg)();return(0,C.jsx)(w,{disabled:b,children:(0,C.jsxs)(h.ZP,{fillWidth:!0,gap:8,fxDirection:"row",children:[(0,C.jsxs)(I,{style:{borderRight:"1px solid ".concat(T.modalBorderColor)},padding:"0 4px 0 0",children:[(0,C.jsx)(B,{justifyContent:"flex-start",children:(0,C.jsx)("img",{src:F,style:{objectFit:"cover",objectPosition:"center"},alt:"",width:"100%"})}),!b&&(0,C.jsxs)(h.ZP,{maxWidth:"125px",justifyContent:"space-between",children:[_&&(0,C.jsx)(y.Z,{label:(0,Z.t)("quantity"),style:{width:"100%",marginBottom:8},disabled:b,children:(0,C.jsx)(S,{value:null===z||void 0===z?void 0:z.quantity,disabled:b})}),(0,C.jsxs)(E,{children:[M&&(0,C.jsx)(W,{variant:"textExtraSmall",disabled:!M,onClick:M,children:(0,Z.t)("Delete")}),P&&(0,C.jsx)(W,{variant:"textExtraSmall",disabled:!P,onClick:P,children:(0,Z.t)("Select")}),p&&(0,C.jsx)(W,{variant:"textExtraSmall",disabled:!p,onClick:p,children:(0,Z.t)("Edit")})]})]})]}),(0,C.jsxs)(h.ZP,{flex:1,gap:2,children:[(0,C.jsx)(h.ZP,{fxDirection:"row",gap:8,fillWidth:!0,alignItems:"flex-start",children:(0,C.jsxs)(h.ZP,{fxDirection:"row",flexWrap:"wrap",gap:8,flex:1,alignItems:"center",padding:"4px 8px",children:[(0,C.jsx)(q,{style:{flex:1},children:null===v||void 0===v||null===(u=v.variation)||void 0===u?void 0:u.label}),(0,C.jsx)(q,{$size:12,colorType:"secondary",children:null===v||void 0===v||null===(s=v.variation)||void 0===s?void 0:s.sku}),(0,C.jsx)(q,{$size:12,colorType:"secondary",children:null===v||void 0===v||null===(c=v.product)||void 0===c?void 0:c.type})]})}),(0,C.jsx)(g.x,{$size:12,$weight:600,children:(0,Z.t)("Properties")}),(0,C.jsx)(D,{fillWidth:!0,alignItems:"flex-start",children:$}),(0,C.jsx)(g.x,{$size:12,$weight:600,children:(0,Z.t)("Summary")}),(0,C.jsx)(k,{fillWidth:!0,alignItems:"flex-start",justifyContent:"space-between",children:N})]})]})})},A=[{label:(0,Z.t)("Price"),name:"out"}]},1392:function(e,n,i){var o=i(3433),t=i(9439),r=i(2791),l=i(7049),a=i(8095),d=i(3855),u=i(6492),s=i(3329);n.Z=function(e){var n=e.options,i=e.onChangeIndex,c=e.currentIndex,v=e.currentOption,f=e.multiple,h=e.onChange,m=e.value,p=e.disabled,x=e.disabledCheck,g=e.renderLabel,Z=(0,r.useState)(0),b=(0,t.Z)(Z,2),j=b[0],C=b[1],P=(0,r.useState)([]),S=(0,t.Z)(P,2),y=S[0],w=S[1],I=(0,r.useCallback)((function(e){f?w((function(n){var i=y.includes(e)?n.filter((function(n){return n!==e})):[].concat((0,o.Z)(n),[e]);return h&&h(i),i})):(w([e]),h&&h([e]))}),[f,h,y]),k=(0,r.useCallback)((function(e){i?i(e):C(e)}),[i]),D=(0,r.useMemo)((function(){return null===n||void 0===n?void 0:n.map((function(e,n){var i=x?x(e,n):p;return(0,s.jsxs)(a.ZP,{fxDirection:"row",gap:8,padding:"2px 4px",alignItems:"center",style:{opacity:i?.7:1,pointerEvents:i?"none":"all"},onClick:function(){i||(k(n),(null===e||void 0===e?void 0:e._id)&&I(null===e||void 0===e?void 0:e._id))},children:[(0,s.jsx)(d.Z,{checked:(null===e||void 0===e?void 0:e._id)&&y.includes(null===e||void 0===e?void 0:e._id)||n===j,size:"22px",disabled:i}),g?g({option:e,index:n,checked:(null===e||void 0===e?void 0:e._id)&&y.includes(null===e||void 0===e?void 0:e._id)||n===j}):(0,s.jsx)(u.x,{children:null===e||void 0===e?void 0:e.label})]},"m-opt_".concat(e.value))}))}),[j,p,x,I,k,n,g,y]);return(0,r.useEffect)((function(){l.sr.isUnd(c)||C(c)}),[c]),(0,r.useEffect)((function(){f||l.sr.isUnd(v)||l.sr.isUnd(n)||C(n.findIndex((function(e){return(null===e||void 0===e?void 0:e.value)===(null===v||void 0===v?void 0:v.value)||(null===e||void 0===e?void 0:e._id)===(null===v||void 0===v?void 0:v._id)})))}),[v,f,n]),(0,r.useEffect)((function(){f&&!l.sr.isUnd(m)&&l.sr.isArray(m)&&w(m)}),[f,m]),(0,s.jsx)(a.ZP,{fillWidth:!0,gap:8,children:D})}},4662:function(e,n,i){var o,t,r,l=i(168),a=i(9439),d=i(3350),u=i(8095),s=i(2928),c=i(2791),v=i(7049),f=i(3544),h=i(4805),m=i(3329),p=(0,d.ZP)(u.ZP)(o||(o=(0,l.Z)(["\n  //min-height: 44px;\n  // border-top: 1px solid ",";\n  // border-bottom: 1px solid ",";\n"])),(function(e){return e.theme.modalBorderColor}),(function(e){return e.theme.modalBorderColor})),x=(0,d.ZP)(s.ZP)(t||(t=(0,l.Z)(["\n  padding-top: 0;\n  padding-bottom: 0;\n\n  flex: 1;\n\n  min-width: min-content;\n  height: 100%;\n"]))),g=(0,d.ZP)(s.ZP)(r||(r=(0,l.Z)(["\n  min-width: 34px;\n  height: 100%;\n  // color: ",";\n  // fill: ",";\n  // background-color: ",";\n  @media screen and (min-width: 480px) {\n    flex: 1;\n  }\n"])),(function(e){return e.theme.accentColor.base}),(function(e){return e.theme.accentColor.base}),(function(e){return e.theme.accentColor.light}));n.Z=function(e){var n=e.steps,i=e.currentIndex,o=void 0===i?0:i,t=e.onNextPress,r=e.onPrevPress,l=e.onCancelPress,d=e.onAcceptPress,u=e.canGoNext,s=void 0===u||u,Z=e.canAccept,b=e.canSubmit,j=e.cancelButton,C=void 0===j||j,P=e.submitButton,S=void 0!==P&&P,y=e.acceptButton,w=e.arrowButtons,I=void 0===w||w,k=e.isLoading,D=(0,h.useMediaQuery)({query:"(max-width: 768px)"}),B=(0,h.useMediaQuery)({query:"(max-width: 480px)"}),q=(0,c.useState)(o),W=(0,a.Z)(q,2),E=W[0],M=W[1],A=(0,c.useMemo)((function(){var e,i;return n&&n[E-1]?{label:null===(e=n[E-1])||void 0===e?void 0:e.label,value:null===(i=n[E-1])||void 0===i?void 0:i.value}:null}),[E,n]),_=(0,c.useMemo)((function(){var e,i;return n&&n[E+1]?{label:null===(e=n[E+1])||void 0===e?void 0:e.label,value:null===(i=n[E+1])||void 0===i?void 0:i.value}:null}),[E,n]),R=(0,c.useCallback)((function(){if(n)if(r){if(0===E)return void(l&&l());var e=E-1;r&&r({option:n[e],value:n[e].value,index:e})}else M((function(e){return 0===e?e:e-1}))}),[E,l,r,n]),z=(0,c.useCallback)((function(){if(n){if(t){var e=E+1;return e===n.length?d&&d():t({option:n[e],value:n[e].value,index:e})}M((function(e){return e+1===n.length?e+1:e}))}}),[E,d,t,n]);return(0,c.useEffect)((function(){v.sr.isNotUnd(o)&&M(o)}),[o]),(0,m.jsxs)(p,{fxDirection:"row",gap:8,fillWidth:!0,children:[C&&!D&&(0,m.jsx)(x,{variant:"defaultSmall",isLoading:k,onClick:l,children:(0,f.t)("Cancel")}),I&&(0,m.jsx)(g,{variant:B?"onlyIconFilled":"filledSmall",icon:"SmallArrowLeft",onClick:R,disabled:k||!A,children:null===A||void 0===A?void 0:A.label}),I&&(0,m.jsx)(g,{variant:B?"onlyIconFilled":"filledSmall",endIcon:"SmallArrowRight",onClick:z,disabled:k||!s||!_,children:null===_||void 0===_?void 0:_.label}),(S||y)&&(0,m.jsx)(x,{variant:"filledSmall",type:b&&S?"submit":"button",onClick:d,isLoading:k,disabled:b&&S?!b:!Z,children:(0,f.t)("Accept")})]})}},1251:function(e,n,i){i.d(n,{Qv:function(){return x},xB:function(){return g},ze:function(){return b}});var o,t,r,l=i(168),a=i(1413),d=i(4925),u=i(2928),s=i(8095),c=i(6492),v=i(3350),f=i(3544),h=i(763),m=i(3329),p=["onClose","onBackPress","title","showSubmitButton","canSubmit","renderTitle"],x=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).error;return(0,m.jsx)("div",{children:"Error: ".concat(e)})},g=function(e){var n=e.onClose,i=e.onBackPress,o=e.title,t=e.showSubmitButton,r=e.canSubmit,l=e.renderTitle,v=(0,d.Z)(e,p);return(0,m.jsx)(Z,(0,a.Z)((0,a.Z)({padding:"4px 0"},v),{},{gap:8,children:(0,m.jsxs)(s.ZP,{fillWidth:!0,fxDirection:"row",justifyContent:"space-between",alignItems:"stretch",height:"32px",children:[i&&(0,m.jsx)(u.ZP,{variant:"textExtraSmall",icon:"SmallArrowLeft",iconSize:"22px",padding:"0",style:{minWidth:"max-content",minHeight:"100%"},onClick:i||n,children:(0,f.t)("Back")}),l||(0,m.jsx)(s.ZP,{justifyContent:"center",overflow:"hidden",children:(0,m.jsx)(c.x,{$weight:600,$size:14,style:{textTransform:"uppercase",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},children:o})}),t&&(0,m.jsx)(u.ZP,{variant:"textExtraSmall",gap:"6px",type:t?"submit":"button",padding:"0 6px",endIcon:"done",endIconSize:"22px",style:{minWidth:"max-content",minHeight:"100%"},disabled:!r,children:"Ok"}),n&&(0,m.jsx)(u.ZP,{variant:"onlyIconNoEffects",icon:"close",iconSize:"95%",size:"24px",padding:"0",onClick:n})]})}))},Z=(0,v.ZP)(s.ZP)(o||(o=(0,l.Z)(["\n  height: 32px;\n"]))),b=function(e){var n=e.submitButtonText,i=void 0===n?"\u041f\u0440\u0438\u0439\u043d\u044f\u0442\u0438":n,o=e.loading,t=e.extraFooter,r=e.canSubmit,l=e.onCreatePress,a=e.resetButtonShown,d=e.onAcceptPress,c=e.canAccept;return(0,m.jsxs)(j,{fillWidth:!0,children:[t,(0,m.jsxs)(s.ZP,{padding:"8px 8px",fxDirection:"row",gap:8,alignItems:"center",children:[a&&(0,m.jsx)(u.ZP,{variant:"onlyIcon",icon:"clear",size:"36px",iconSize:"80%",type:"reset"}),l&&(0,m.jsx)(u.ZP,{variant:"onlyIcon",icon:"plus",size:"36px",iconSize:"80%",onClick:l}),(0,m.jsx)(u.ZP,{variant:"filledMiddle",flex:1,type:(0,h.isUndefined)(r)?"button":"submit",style:{padding:"0 12px"},textTransform:"uppercase",fontWeight:600,endIcon:"SmallArrowRight",endIconSize:"24px",disabled:(0,h.isUndefined)(r)?!c:!r,isLoading:o,onClick:d,children:i})]})]})},j=(0,v.ZP)(s.ZP)(t||(t=(0,l.Z)([""])));v.ZP.form(r||(r=(0,l.Z)(["\n  flex: 1;\n\n  display: flex;\n  flex-direction: column;\n\n  width: 100%;\n  max-width: 480px;\n\n  padding: 0 8px;\n\n  background-color: ",";\n"])),(function(e){return e.theme.modalBackgroundColor}))},1186:function(e,n,i){i.d(n,{f:function(){return t}});var o=i(3544),t=[{top:{name:"".concat((0,o.t)("label"),"/").concat((0,o.t)("name")),getData:function(e){var n,i=null!==(n=e.label)&&void 0!==n?n:e.name;return i?Object.values(i).map((function(e){return null!==e&&void 0!==e?e:""})).join(" "):"---"}},bottom:{name:"\u0406\u041f\u041d/\u0404\u0414\u0420\u041f\u041e\u0423",getData:function(e){var n,i;return((null===(n=e.taxCode)||void 0===n?void 0:n.personal)||"---")+"/"+((null===(i=e.taxCode)||void 0===i?void 0:i.corp)||"---")}},width:"240px",action:"doubleDataWithAvatar"},{top:{name:"\u0422\u0438\u043f",getData:function(e){return null===e||void 0===e?void 0:e.type}},bottom:{name:"\u0421\u0442\u0430\u0442\u0443\u0441",path:"status"},width:"120px",action:"valueByPath"},{top:{name:"\u0415\u043c\u0435\u0439\u043b",path:"email",uppercase:!1},bottom:{name:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d",path:"phone"},width:"170px",action:"contacts"},{top:{name:"\u041b\u043e\u043a\u0430\u0446\u0456\u044f"},width:"170px",action:"valueByPath"},{top:{name:"\u0422\u0435\u0433\u0438",path:"tags"},width:"200px",action:"tags"},{top:{name:"\u041a\u043e\u043c\u0435\u043d\u0442\u0430\u0440",path:"description"},width:"170px",action:"valueByPath"},{top:{name:"\u0421\u0442\u0432\u043e\u0440\u0435\u043d\u043e",align:"center",path:"createdAt"},bottom:{name:"\u041e\u043d\u043e\u0432\u043b\u0435\u043d\u043e",align:"center",path:"updatedAt"},width:"150px",action:"dateSimple"}]}}]);
//# sourceMappingURL=491.250e6106.chunk.js.map