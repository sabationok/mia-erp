"use strict";(self.webpackChunkmia_erp=self.webpackChunkmia_erp||[]).push([[588],{9184:function(n,e,i){var t,o,r,l,d=i(168),a=i(4165),s=i(4942),c=i(1413),u=i(5861),f=i(3433),h=i(9439),p=i(2791),v=i(8095),m=i(3350),x=i(870),g=i(3855),Z=i(6492),b=i(7348),w=i(2928),j=i(3329);e.Z=function(n){var e=n.onChangeIds,i=n.onChange,t=n.offer,o=(0,b.q$)(x.cA.CATEGORIES_PROD).directory,r=(0,p.useState)({}),l=(0,h.Z)(r,2),d=l[0],m=l[1],g=(0,p.useMemo)((function(){var n;if(null!==t&&void 0!==t&&t.categories){var e={};return null===t||void 0===t||null===(n=t.categories)||void 0===n||n.forEach((function(n){var i,t=null===(i=n.parent)||void 0===i?void 0:i._id,o=null===n||void 0===n?void 0:n._id;o&&(t&&(e[t]=e[t]?[].concat((0,f.Z)(e[t]),[o]):[o]),e[o]=e[o]?[].concat((0,f.Z)(e[o]),[o]):[o])})),Object.entries(e).forEach((function(n){var i,t=(0,h.Z)(n,2),o=t[0],r=t[1];(null===(i=e[o])||void 0===i?void 0:i.length)>1&&(e[o]=Array.from(new Set(r)))})),e}}),[null===t||void 0===t?void 0:t.categories]);(0,p.useEffect)((function(){g&&m(g)}),[]);var Z=(0,p.useCallback)(function(){var n=(0,u.Z)((0,a.Z)().mark((function n(t){return(0,a.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i&&i(t._id),m((function(n){var i,o=t.checked?(0,c.Z)((0,c.Z)({},n),{},(0,s.Z)({},t._id,[t._id])):(0,c.Z)((0,c.Z)({},n),{},(0,s.Z)({},t._id,[]));if(t.checked){var r=t.pathIds;t.pathIds.forEach((function(n,e){var i;(r=r.slice(1,r.length),n===t._id)?o[n]=[n]:o[n]=(0,f.Z)(new Set([].concat((0,f.Z)(null!==(i=o[n])&&void 0!==i?i:[]),(0,f.Z)(r))))}))}else{var l;null===n||void 0===n||null===(l=n[t._id])||void 0===l||l.forEach((function(n){o[n]=[]})),o[t._id]=[]}return e&&e((i=o,Object.keys(i).filter((function(n){var e;return null===i||void 0===i||null===(e=i[n])||void 0===e?void 0:e.length})))),o}));case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),[i,e]),w=(0,p.useMemo)((function(){var n=function(n){var e;return!(null===d||void 0===d||null===(e=d[n])||void 0===e||!e.length)};return o.map((function(e){return(0,j.jsx)(C,{children:(0,j.jsx)(k,{item:e,depth:0,pathIds:[],isChecked:n,onChange:Z})},e._id)}))}),[d,Z,o]);return(0,j.jsx)(v.ZP,{minWidth:"max-content",children:w})};var C=(0,m.ZP)(v.ZP)(t||(t=(0,d.Z)(["\n  //padding: 8px 0;\n  // &:not(:first-child) {\n  //   border-top: 1px solid ",";\n  // }\n"])),(function(n){return n.theme.sideBarBorderColor})),y=(0,m.ZP)(v.j6)(o||(o=(0,d.Z)([""]))),P=(0,m.ZP)(v.Ov)(r||(r=(0,d.Z)(["\n  &:not(:last-child) {\n  }\n\n  min-width: max-content;\n"]))),S=(0,m.ZP)(v.ZP)(l||(l=(0,d.Z)(["\n  border-bottom: 1px solid ",";\n"])),(function(n){return n.theme.sideBarBorderColor})),k=function n(e){var i,t,o,r,l=e.pathIds,d=e.item,a=e.depth,s=void 0===a?0:a,c=e.onChange,u=e.isChecked,m=(0,p.useState)(!(null===d||void 0===d||null===(i=d.childrenList)||void 0===i||!i.length)),x=(0,h.Z)(m,2),b=x[0],C=x[1],k=null!==(t=null===d||void 0===d?void 0:d._id)&&void 0!==t?t:"",_=[].concat((0,f.Z)(l),[k]);return(0,j.jsxs)(P,{padding:s?"0 0 0 16px":"",children:[(0,j.jsxs)(S,{gap:12,fxDirection:"row",alignItems:"center",padding:"8px 0",children:[(0,j.jsx)(w.ZP,{variant:"onlyIconNoEffects",iconSize:"22px",disabled:!(null!==d&&void 0!==d&&null!==(o=d.childrenList)&&void 0!==o&&o.length),icon:b?"SmallArrowDown":"SmallArrowRight",onClick:function(){C((function(n){return!n}))}}),(0,j.jsxs)(v.HN,{flex:1,fxDirection:"row",alignItems:"center",gap:12,padding:"4px 6px",children:[(0,j.jsx)(g.Z,{size:"22px",checked:!!u&&u(k),onChange:function(n){c&&c({pathIds:_,_id:k,checked:n.checked})}}),(0,j.jsx)(Z.x,{$size:14,$weight:500,children:d.label})]})]}),b&&(0,j.jsx)(y,{children:null===(r=d.childrenList)||void 0===r?void 0:r.map((function(e){return(0,j.jsx)(n,{depth:s+1,item:e,onChange:c,isChecked:u,pathIds:_},e._id)}))})]},"cate-value-".concat(k))}},8926:function(n,e,i){i.d(e,{Z:function(){return ln}});var t,o,r,l,d,a,s,c,u,f=i(168),h=i(4942),p=i(1413),v=i(3433),m=i(9439),x=i(8095),g=i(2791),Z=i(3350),b=i(6492),w=i(3665),j=i(4925),C=i(9656),y=i(4652),P=i(4990),S=i(6681),k=i(9964),_=i(2928),I=i(4897),B=i(3329),D=["title","fillHeight","onSubmit","onClose","defaultState","type"],z=Z.ZP.div(t||(t=(0,f.Z)(["\n  flex: 1;\n\n  display: grid;\n  grid-template-columns: 1fr;\n  grid-template-rows: 1fr min-content min-content;\n  gap: 6px;\n\n  padding: 8px;\n  overflow: hidden;\n"]))),E=Z.ZP.label(o||(o=(0,f.Z)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  height: 100%;\n  width: 100%;\n  max-height: 100%;\n\n  fill: ",";\n\n  border-radius: 2px;\n  border: 2px solid ",";\n\n  transition: ",";\n\n  pointer-events: ",";\n  &:hover {\n    fill: ",";\n    border-color: ",";\n  }\n"])),(function(n){return n.theme.sideBarBorderColor}),(function(n){return n.theme.sideBarBorderColor}),(function(n){return n.theme.globals.timingFnMui}),(function(n){return n.disabled?"none":"all"}),(function(n){return n.theme.accentColor.base}),(function(n){return n.theme.accentColor.light})),M=Z.ZP.img(r||(r=(0,f.Z)(["\n  //min-width: 100px;\n  //max-width: 100px;\n  //\n  //height: 145px;\n\n  max-height: 100%;\n"]))),L=function(n){var e,i=n.title,t=n.fillHeight,o=void 0===t||t,r=n.onSubmit,l=n.onClose,d=n.defaultState,a=(n.type,(0,j.Z)(n,D)),s=(0,g.useState)(I.E_[0]),c=(0,m.Z)(s,2),u=c[0],f=c[1],v=(0,g.useState)(d||{}),Z=(0,m.Z)(v,2),b=Z[0],w=Z[1],L=(0,g.useRef)(null);return(0,B.jsx)(C.Z,(0,p.Z)((0,p.Z)({title:i||"\u0414\u043e\u0434\u0430\u0442\u0438 \u043d\u043e\u0432\u0438\u0439 \u0441\u0435\u0442 \u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u044c",fillHeight:o},a),{},{width:"360px",onClose:l,onSubmit:function(){r&&r(b),l&&l()},children:(0,B.jsxs)(z,{children:[(0,B.jsx)(x.ZP,{fillWidth:!0,fillHeight:!0,alignItems:"center",overflow:"hidden",children:null!==u&&void 0!==u&&u.value&&b[null===u||void 0===u?void 0:u.value]?(0,B.jsx)(M,{src:b[null===u||void 0===u?void 0:u.value]}):(0,B.jsxs)(E,{disabled:!0,children:[(0,B.jsx)(y.Z,{icon:"plus",size:"56px"}),(0,B.jsx)("input",{name:"img_preview",type:"file",className:"visually-hidden",disabled:!0})]})}),(null===u||void 0===u?void 0:u.value)&&(0,B.jsxs)(x.ZP,{fxDirection:"row",gap:6,alignItems:"flex-end",children:[(0,B.jsx)(P.Z,{label:null===u||void 0===u||null===(e=u.label)||void 0===e?void 0:e.replace("img_","image ").toUpperCase(),required:null===u||void 0===u?void 0:u.required,children:(0,B.jsx)(S.ZP,{ref:L,name:null===u||void 0===u?void 0:u.value,value:b[null===u||void 0===u?void 0:u.value]||"",onChange:function(n){var e=n.target,i=e.name,t=e.value;w((function(n){return(0,p.Z)((0,p.Z)({},n),{},(0,h.Z)({},i,t))}))},placeholder:"\u0412\u043f\u0438\u0448\u0456\u0442\u044c \u0430\u0431\u043e \u0432\u0441\u0442\u0430\u0432\u0442\u0435 \u043f\u043e\u0441\u0438\u043b\u0430\u043d\u043d\u044f \u043d\u0430 \u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u043d\u044f",required:null===u||void 0===u?void 0:u.required,autoFocus:!0})}),(0,B.jsx)(_.ZP,{variant:"onlyIcon",icon:"close",size:"28px",iconSize:"100%",onClick:function(){var n=null===u||void 0===u?void 0:u.value;n&&w((function(e){return(0,p.Z)((0,p.Z)({},e),{},(0,h.Z)({},n,""))}))}})]}),(0,B.jsx)(x.ZP,{padding:"8px 0",children:(0,B.jsx)(k.Z,{options:I.E_,currentOption:u,onSelect:function(n){f(n.option)}})})]})}))},$=i(4717),O=i(107),T=i(755),H=i(763),N=i(1347),W=i(7348),A=i(1134),F=i(8007),U=i(4695),V=i(1577),R=i(9541),q=["onSuccess","onClose","offerId"],K=["image/jpeg","image/png","image/webp"],J='Only "'.concat(K.map((function(n){return n.replace("image/","").toUpperCase()})).join(", "),'" formats are accepted'),G=F.object().shape({file:F.mixed().test("fileType",J,(function(n){var e=n;return e&&K.includes(e.type)})).test("fileSize",(0,O.t)("File size must be less than 5MB"),(function(n){return n&&n.size<=5242880}))}),X=(0,Z.ZP)(x._0)(l||(l=(0,f.Z)(["\n  flex: 1;\n  padding: 16px 8px;\n  overflow: hidden;\n"]))),Q=(0,Z.ZP)(x.HN)(d||(d=(0,f.Z)(["\n  position: relative;\n  align-items: center;\n  justify-content: center;\n\n  height: 100%;\n  width: 100%;\n  max-height: 100%;\n\n  & .icon {\n    fill: ",";\n    transition: ",";\n  }\n\n  border-radius: 4px;\n  border: 2px solid ",";\n\n  transition: ",";\n\n  &:hover {\n    & .icon {\n      fill: ",";\n    }\n\n    border-color: ",";\n  }\n\n  &[disabled] {\n    pointer-events: none;\n  }\n"])),(function(n){return n.theme.sideBarBorderColor}),(function(n){return n.theme.globals.timingFnMui}),(function(n){return n.theme.sideBarBorderColor}),(function(n){return n.theme.globals.timingFnMui}),(function(n){return n.theme.accentColor.base}),(function(n){return n.theme.accentColor.light})),Y=Z.ZP.img(a||(a=(0,f.Z)(["\n  //min-width: 100px;\n  //max-width: 100px;\n  //\n  //height: 145px;\n  width: 100%;\n"]))),nn=(0,Z.ZP)(x.ZP)(s||(s=(0,f.Z)(["\n  max-width: 100%;\n  width: 100%;\n  max-height: 100%;\n  object-fit: cover;\n  aspect-ratio: 1/35;\n\n  overflow: hidden;\n"]))),en=(0,Z.ZP)(x.ZP)(c||(c=(0,f.Z)(["\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  width: 100%;\n\n  backdrop-filter: blur(3px);\n"]))),tn=function(n){var e,i,t,o=n.onSuccess,r=n.onClose,l=n.offerId,d=((0,j.Z)(n,q),(0,R.J)({processing:{content:"Loading..."}})),a=(0,W.O5)(),s=(0,A.cI)({defaultValues:{mimeType:"image/jpeg",type:"image",offerId:l,fileName:[null===(e=a.permission.company)||void 0===e?void 0:e._id,l].filter((function(n){return!!n})).join("/")},resolver:(0,U.X)(G),reValidateMode:"onChange",mode:"onChange"}),c=(s.watch(),(0,g.useState)("")),u=(0,m.Z)(c,2),f=u[0],h=u[1],v=s.watch("file");return(0,g.useEffect)((function(){if(v)try{var n=URL.createObjectURL(v);return h(n),function(){return URL.revokeObjectURL(n)}}catch(e){console.log(e)}else h("")}),[v]),(0,g.useEffect)((function(){console.log({preview:f,file:v})}),[v,f]),(0,B.jsx)(V.Z,{title:"\u0417\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0438\u0442\u0438 \u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u043d\u044f",fillHeight:!0,width:"360px",onClosePress:r,children:(0,B.jsxs)(X,{onSubmit:s.handleSubmit((function(n){var e;(0,N.k_)(N.L.Client.uploadFile,{data:(0,p.Z)((0,p.Z)({},n),{},{mimeType:null===(e=n.file)||void 0===e?void 0:e.type}),logError:!0,logRes:!0,onLoading:d.onLoading("processing"),onSuccess:function(n){console.log(n),o&&o(n),r&&r()},onError:function(){console.error({fData:n})}})}),(function(n){console.error("Upload image form error",n)})),children:[(0,B.jsx)(x.ZP,{fillWidth:!0,fillHeight:!0,alignItems:"center",overflow:"hidden",children:(0,B.jsxs)(Q,{children:[f?(0,B.jsx)(nn,{children:(0,B.jsx)(Y,{src:f})}):(0,B.jsx)(y.Z,{className:"icon",icon:"plus",size:"56px"}),(0,B.jsx)("input",{accept:K.join(", "),name:"file",onChange:function(n){var e=n.target.files;if(e){var i=e[0];s.setValue("file",i,{shouldDirty:!0,shouldTouch:!0,shouldValidate:!0}),s.setValue("mimeType",i.type,{shouldDirty:!0,shouldTouch:!0,shouldValidate:!0})}s.trigger("file",{}).then((function(){s.clearErrors("file")})).catch((function(){s.resetField("file",{keepError:!0}),s.resetField("mimeType",{keepError:!0})}))},type:"file",className:"visually-hidden"}),(null===(i=s.formState.errors)||void 0===i?void 0:i.file)&&(0,B.jsx)(en,{padding:"16px",children:(0,B.jsx)(b.x,{$weight:600,$size:13,children:null===(t=s.formState.errors)||void 0===t?void 0:t.file.message})})]})}),(0,B.jsxs)(x.ZP,{padding:"16px 0 0",gap:12,fxDirection:"row",children:[(0,B.jsx)(_.ZP,{sizeType:"middle",variant:"def",onClick:r,children:(0,O.t)("Back")}),(0,B.jsx)(_.ZP,{sizeType:"middle",variant:"outlined",onClick:function(){s.unregister("file")},margin:"0 auto 0 0",children:(0,O.t)("Clear")}),(0,B.jsx)(_.ZP,{type:"submit",sizeType:"middle",variant:"filled",children:(0,O.t)("Accept")})]})]})})},on=(0,Z.ZP)(x.ZP)(u||(u=(0,f.Z)(["\n  & .scrollBox {\n    &::-webkit-scrollbar {\n      width: 0;\n      height: 0;\n    }\n  }\n"]))),rn=function(n){var e=n.onMoveUpPress,i=n.onMoveDownPress,t=n.currentOrder,o=n.canMoveDown,r=n.canMoveUp;return(0,B.jsxs)(x.ZP,{style:{minWidth:"fit-content"},fillHeight:!0,gap:6,justifyContent:"space-between",overflow:"hidden",children:[(0,B.jsx)(_.ZP,{variant:"onlyIcon",icon:"SmallArrowUp",disabled:!r,onClick:e}),(0,B.jsx)(b.x,{$align:"center",$weight:600,children:t||0}),(0,B.jsx)(_.ZP,{variant:"onlyIcon",icon:"SmallArrowDown",disabled:!o,onClick:i})]})},ln=function(n){var e=n.onChangeState,i=n.renderHeader,t=n.initialData,o=n.canEditOrder,r=void 0===o||o,l=n.onClose,d=n.FooterComponent,a=n.contentContainerStyle,s=n.hideLabel,c=n.onlyPreviews,u=void 0===c||c,f=n.offerId,Z=(0,w.kw)(),j=(0,g.useState)([]),C=(0,m.Z)(j,2),y=C[0],P=C[1];(0,g.useEffect)((function(){t&&P(t)}),[t]);var S=function(n){if(e){var i=[].concat((0,v.Z)(null!==t&&void 0!==t?t:[]),[(0,p.Z)((0,p.Z)({},n),{},{order:y.length+1})]);e(i)}else P((function(e){return[].concat((0,v.Z)(e),[(0,p.Z)((0,p.Z)({},n),{},{order:y.length+1})])}))},k=(0,g.useCallback)((function(n,e){P((function(i){var t=n+e;return i.map((function(e,i){return t>y.length||t<1?e:e.order===t?(0,p.Z)((0,p.Z)({},e),{},{order:n}):e.order===n?(0,p.Z)((0,p.Z)({},e),{},{order:t}):e}))}))}),[y.length]),D=(0,g.useCallback)((function(n){var i=n.setIndex,o=n.type,r=n.uri;if(e&&t){var l=null===t||void 0===t?void 0:t.map((function(n,e){return i===e?(0,p.Z)((0,p.Z)({},n),{},(0,h.Z)({},o,r)):n}));e(l)}else P((function(n){return n.map((function(n,e){return i===e?(0,p.Z)((0,p.Z)({},n),{},(0,h.Z)({},o,r)):n}))}))}),[t,e]),z=(0,g.useCallback)((function(n){n.setId;var i=n.setIndex,t=n.type;(t!==T.Q.img_preview||window.confirm("\u0411\u0443\u0434\u0435 \u0432\u0438\u0434\u0430\u043b\u0435\u043d\u043e \u0446\u0456\u043b\u0438\u0439 \u0441\u0435\u0442 \u0444\u043e\u0442\u043e.\n\u041f\u0440\u043e\u0434\u043e\u0432\u0436\u0438\u0442\u0438?"))&&P((function(n){var o=n.map((function(n,e){return i===e?(0,p.Z)((0,p.Z)({},n),{},(0,h.Z)({},t,"")):n})).filter((function(n){return n.img_preview})).map((function(n,e){return(0,p.Z)((0,p.Z)({},n),{},{order:e+1})}));return e&&e(o),o}))}),[e]),E=function(){Z.create(L,{onSubmit:function(n){S(n)}})},M=(0,g.useMemo)((function(){var n,e=y;try{e=(0,v.Z)(y).sort((function(n,e){var i,t;return(null!==(i=null===n||void 0===n?void 0:n.order)&&void 0!==i?i:0)-(null!==(t=null===e||void 0===e?void 0:e.order)&&void 0!==t?t:0)}))}catch(i){e=y}return null===(n=e)||void 0===n?void 0:n.map((function(n,i){var t,o,l,d=(u?I.E_.slice(0,1):I.E_).map((function(e,t){var o;return(0,B.jsx)($.Z,{src:n[null===e||void 0===e?void 0:e.value],title:null!==(o=e.label)&&void 0!==o?o:"",onEditPress:function(){Z.open({ModalChildren:L,modalChildrenProps:{defaultState:n,type:e.value,onSubmit:function(t){e.value&&t[e.value]&&D({setId:null===n||void 0===n?void 0:n._id,setIndex:i,uri:t[e.value],type:e.value})}}})},onDeletePress:function(){z({setId:"",setIndex:i,type:e.value})}},"small-prev_".concat(t))}));return(0,B.jsxs)(on,{gap:6,fxDirection:"row",maxWidth:"100%",overflow:"hidden",children:[(null===(t=e)||void 0===t?void 0:t.length)>1&&r&&!u&&(0,B.jsx)(rn,{currentOrder:null===n||void 0===n?void 0:n.order,canMoveUp:(null!==(o=null===n||void 0===n?void 0:n.order)&&void 0!==o?o:0)>1,onMoveUpPress:function(){(0,H.isNumber)(n.order)&&k(n.order,-1)},canMoveDown:(null!==(l=null===n||void 0===n?void 0:n.order)&&void 0!==l?l:0)<y.length,onMoveDownPress:function(){(0,H.isNumber)(n.order)&&k(n.order,1)}}),(0,B.jsx)(x.ZP,{className:"scrollBox",overflow:"auto",gap:6,fxDirection:"row",children:d})]},"images-set_".concat((null===n||void 0===n?void 0:n._id)||i))}))}),[r,y,D,k,z,Z,u]);return(0,g.useEffect)((function(){t&&P(t)}),[]),(0,B.jsxs)(x.ZP,{maxWidth:"100%",overflow:"hidden",flex:1,children:[i||(0,B.jsxs)(x.ZP,{padding:"4px 8px",height:"32px",fxDirection:"row",gap:2,alignItems:"center",justifyContent:"space-between",children:[(0,B.jsx)(b.x,{$weight:600,$size:14,children:!s&&(0,O.t)("Images")}),(0,B.jsx)(_.ZP,{type:"button",variant:"textExtraSmall",onClick:l||E,children:l?(0,O.t)("Close"):(0,O.t)("Add")})]}),(0,B.jsx)(x.ZP,{gap:6,padding:"8px 0",style:a,fxDirection:u?"row":"column",flexWrap:u?"wrap":"unset",children:M}),(0,B.jsx)(x.ZP,{padding:"16px 8px",children:(0,B.jsx)(_.ZP,{variant:"filled",sizeType:"middle",onClick:function(){Z.create(tn,{offerId:f,onSuccess:function(n){S({img_preview:n.url})}})},children:"Upload"})}),d&&(0,B.jsx)(d,{onAddNewImageSetPress:E})]})}},4809:function(n,e,i){var t,o,r,l=i(168),d=i(7762),a=i(9439),s=i(4942),c=i(7533),u=i(2791),f=i(6492),h=i(3350),p=i(2928),v=i(8095),m=i(7348),x=i(107),g=i(7802),Z=i(4652),b=i(3329),w=(t={},(0,s.Z)(t,c.b2.size,{numColumns:4}),(0,s.Z)(t,c.b2.color,{numColumns:2}),(0,s.Z)(t,c.b2.style,{numColumns:2}),(0,s.Z)(t,c.b2.care,{numColumns:1}),t),j=(0,h.ZP)(v.ZP)(o||(o=(0,l.Z)(["\n  &:not(:first-child) {\n    border-top: 1px solid ",";\n  }\n\n  //padding-bottom: 8px;\n\n  &:last-child {\n    border-bottom: 1px solid ",";\n  }\n"])),(function(n){return n.theme.sideBarBorderColor}),(function(n){return n.theme.sideBarBorderColor})),C=(0,h.ZP)(v.ZP)(r||(r=(0,l.Z)(["\n  border-top: 1px solid ",";\n"])),(function(n){return n.theme.sideBarBorderColor}));e.Z=function(n){var e,i,t,o,r=n.item,l=n.selectedIds,s=n.onSelect,c=n.isOpen,h=n.multiple,y=n.onChangeIds,P=(0,m.i7)(),S=(0,u.useState)(null!==c&&void 0!==c&&c),k=(0,a.Z)(S,2),_=k[0],I=k[1],B=(0,u.useMemo)((function(){var n,e,i;if(null!==(n=r.childrenList)&&void 0!==n&&n.length)return r.childrenList;var t,o=null===r||void 0===r?void 0:r._id,l=[],a=null!==(e=null===(i=P.propertiesKeysMap)||void 0===i?void 0:i[o])&&void 0!==e?e:[],s=(0,d.Z)(a);try{for(s.s();!(t=s.n()).done;){var c,u=t.value,f=null===(c=P.propertiesDataMap)||void 0===c?void 0:c[u];f&&l.push(f)}}catch(h){s.e(h)}finally{s.f()}return l}),[null===r||void 0===r?void 0:r._id,r.childrenList,P.propertiesDataMap,P.propertiesKeysMap]);(0,u.useEffect)((function(){null!==B&&void 0!==B&&B.length&&I(!0)}),[null===B||void 0===B?void 0:B.length]);var D=null!==(e=r.cmsConfigs)&&void 0!==e&&e.type?null===w||void 0===w?void 0:w[null===(i=r.cmsConfigs)||void 0===i?void 0:i.type]:void 0;return(0,b.jsxs)(j,{fillWidth:!0,children:[(0,b.jsxs)(p.ZP,{gap:8,fxDirection:"row",padding:"6px 0",justifyContent:"space-between",alignItems:"center",onClick:function(){I((function(n){return!n}))},children:[(0,b.jsx)(f.x,{$weight:500,$padding:"0 8px",children:r.label}),(0,b.jsx)(Z.Z,{size:"28px",icon:_?"SmallArrowDown":"SmallArrowLeft"})]}),_&&(0,b.jsxs)(C,{padding:"8px 0",children:[(null===(t=r.cmsConfigs)||void 0===t?void 0:t.type)&&(0,b.jsx)(v.ZP,{gap:6,padding:"6px",justifyContent:"center",alignItems:"center",children:(0,b.jsxs)(f.x,{$size:11,$weight:400,children:[(0,x.t)("Cms type:")," ",'"'.concat(null===(o=r.cmsConfigs)||void 0===o?void 0:o.type,'"')]})}),(0,b.jsx)(g.Z,{numColumns:null===D||void 0===D?void 0:D.numColumns,name:r._id,multiple:h,value:l,options:B,onSelectValue:function(n){s&&s(n.name,n.value)},onChange:function(n){y&&y(r._id,n)}})]})]},"property-box-".concat(r._id))}},4717:function(n,e,i){var t,o,r,l=i(168),d=i(9439),a=i(2928),s=i(6492),c=i(3350),u=i(8095),f=i(2791),h=i(4652),p=i(3329),v=(0,c.ZP)(u.ZP)(t||(t=(0,l.Z)(["\n  min-width: 115px;\n\n  aspect-ratio: 1/1.35;\n\n  object-position: center;\n  object-fit: contain;\n\n  pointer-events: ",";\n\n  &:hover {\n    & .top {\n      min-height: 36px;\n    }\n  }\n"])),(function(n){return n.disabled?"none":"all"})),m=(0,c.ZP)(u.ZP)(o||(o=(0,l.Z)(["\n  height: 0;\n  min-height: 0;\n  padding: 0 6px;\n  overflow: hidden;\n\n  transition: min-height ",";\n"])),(function(n){return n.theme.globals.timingFnMain})),x=(0,c.ZP)(u.ZP)(r||(r=(0,l.Z)(["\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  z-index: 5;\n\n  background-color: rgba(26, 26, 26, 0.2);\n  backdrop-filter: blur(3px);\n"])));e.Z=function(n){var e=n.title,i=n.src,t=n.onDeletePress,o=n.onEditPress,r=n.disabled,l=(n.maxWidth,n.maxHeight,(0,f.useState)(!1)),c=(0,d.Z)(l,2),g=c[0],Z=c[1];return(0,p.jsxs)(v,{className:"ImagePreview_".concat(e),fillWidth:!0,overflow:"hidden",alignItems:"center",justifyContent:"center",gap:4,border:g?"":"1px solid lightgrey",borderRadius:"4px",style:{position:"relative"},disabled:r,children:[i?(0,p.jsx)("img",{src:i,alt:e||"img_title",style:{width:"100%"},onLoad:function(){Z(!0)}}):(0,p.jsx)(h.Z,{icon:"gallery",size:"28px",fill:"lightgrey"}),(0,p.jsxs)(x,{fillWidth:!0,children:[e&&(0,p.jsx)(u.ZP,{padding:"6px 8px",children:(0,p.jsx)(s.x,{$size:12,$weight:500,color:"#fff",children:e})}),(0,p.jsxs)(m,{className:"top",fxDirection:"row",gap:6,style:{fill:"#fff"},alignItems:"center",justifyContent:"space-between",fillWidth:!0,children:[(0,p.jsx)(a.ZP,{variant:"onlyIcon",icon:"edit",iconSize:"28px",disabled:!o,onClick:o}),(0,p.jsx)(a.ZP,{variant:"onlyIcon",icon:"delete",iconSize:"28px",disabled:!t,onClick:t})]})]})]})}},1577:function(n,e,i){var t,o,r=i(168),l=i(1413),d=i(4925),a=i(3350),s=i(2791),c=i(7121),u=i(3329),f=["title","footer","children","extraFooter","extraHeader","isLoading","onClosePress","onBackPress","okButton","canSubmit"],h=function(n){var e=n.title,i=(n.footer,n.children),t=(n.extraFooter,n.extraHeader),o=(n.isLoading,n.onClosePress),r=n.onBackPress,a=n.okButton,s=n.canSubmit,h=(0,d.Z)(n,f);return(0,u.jsxs)(p,(0,l.Z)((0,l.Z)({className:"modal_base"},h),{},{children:[(0,u.jsx)(c.OX,{onBackPress:r,onClosePress:o,title:e,canSubmit:s,okButton:a,children:t}),(0,u.jsx)(v,{className:"main",children:i})]}))},p=a.ZP.div(t||(t=(0,r.Z)(["\n  display: grid;\n  grid-template-columns: 1fr;\n  grid-template-rows: min-content 1fr max-content;\n\n  position: relative;\n  padding: 0 8px;\n\n  min-height: 200px;\n  max-height: 90vh;\n\n  color: ",";\n  width: ",";\n  height: ",";\n\n  min-width: 250px;\n  max-width: 100%;\n\n  //overflow: hidden;\n\n  box-shadow: ",";\n  fill: ",";\n  color: ",";\n  background-color: ",";\n\n  border-radius: 2px;\n  border-bottom: 1px solid ",";\n  /* resize: both; */\n\n  @media screen and (max-width: 480px) {\n    width: 98vw;\n  }\n\n  @media screen and (min-width: 480px) {\n    width: ",";\n  }\n"])),(function(n){return n.theme.fontColorSidebar}),(function(n){var e=n.width,i=void 0===e?"480px":e,t=n.fillWidth,o=n.fitContentH;return(t?"100vw":o&&"max-content")||i}),(function(n){var e=n.height,i=void 0===e?"":e,t=n.fillHeight,o=n.fitContentV;return(t?"90vh":o&&"max-content")||i}),(function(n){return n.theme.globals.shadowMain}),(function(n){return n.theme.fillColor}),(function(n){return n.theme.fontColor}),(function(n){return n.theme.modalBackgroundColor}),(function(n){return n.theme.modalBorderColor}),(function(n){return n.fillWidth?"98vw":"450px"})),v=a.ZP.main(o||(o=(0,r.Z)(["\n  display: flex;\n  flex-direction: column;\n\n  overflow: auto;\n  position: relative;\n  height: 100%;\n  max-width: 100%;\n  max-height: 100%;\n  width: 100%;\n\n  background-color: ",";\n\n  ::-webkit-scrollbar {\n    width: 4px;\n    height: 4px;\n  }\n  //border-right: 1px solid ",";\n  //border-left: 1px solid ",";\n"])),(function(n){return n.theme.modalBackgroundColor}),(function(n){return n.theme.modalBorderColor}),(function(n){return n.theme.modalBorderColor}));e.Z=(0,s.memo)(h)},2825:function(n,e,i){i.d(e,{c:function(){return b}});var t=i(7762),o=i(1413),r=i(9439),l=i(3691),d=i(7348),a=i(2791),s=i(8095),c=i(4990),u=i(107),f=i(9964),h=i(3383),p=i(9953),v=i(6492),m=i(9541),x=i(1819),g=i(2928),Z=i(3329),b=function(n){var e=n.selected,i=n.onSelect,b=n.filterValue,w=n.hasFilter,j=void 0!==w&&w,C=n.defaultValue,y=(0,d.i7)(),P=(0,a.useState)((0,o.Z)({type:l.iv.GOODS,isSelectable:!0},b)),S=(0,r.Z)(P,2),k=S[0],_=S[1],I=(0,a.useState)(C),B=(0,r.Z)(I,2),D=B[0],z=B[1],E=(0,m.J)(),M=(0,x.xc)().get(x.EJ.offers),L=(0,a.useMemo)((function(){var n;if(null!==(n=y.properties)&&void 0!==n&&n.length)return y.properties.filter((function(n){return!n.parent}));var e,i=y.propertiesByTypeKeysMap[k.type],o=[],r=(0,t.Z)(i);try{for(r.s();!(e=r.n()).done;){var l,d=e.value,a=null===(l=y.propertiesDataMap)||void 0===l?void 0:l[d];(null===a||void 0===a||!a.parent)&&a&&o.push(a)}}catch(s){r.e(s)}finally{r.f()}return o}),[k.type,y.properties,y.propertiesByTypeKeysMap,y.propertiesDataMap]);return(0,a.useEffect)((function(){e&&z(e)}),[e]),(0,a.useEffect)((function(){if(null!==L&&void 0!==L&&L.length&&!e){var n=L.find((function(n){return n._id===(null===D||void 0===D?void 0:D._id)}));i&&n?i(n):z(n)}}),[null===D||void 0===D?void 0:D._id,i,L,e]),(0,Z.jsxs)(s.ZP,{gap:8,children:[(0,Z.jsxs)(s.ZP,{padding:"4px 8px",fxDirection:"row",gap:12,alignItems:"center",fillWidth:!0,justifyContent:"space-between",children:[(0,Z.jsx)(g.ZP,{variant:"text",sizeType:"extraSmall",isLoading:E.isLoading.refreshTree,onClick:function(){M.getAllProperties({params:{dataView:"tree",depth:3},onLoading:E.onLoading("refreshTree")})},children:(0,u.t)("Refresh")}),(0,Z.jsx)(g.ZP,{variant:"text",sizeType:"extraSmall",children:(0,u.t)("Add")})]}),j&&(0,Z.jsx)(c.Z,{label:(0,u.t)("Select type"),children:(0,Z.jsx)(f.Z,{options:h.LC,value:k.type,onSelect:function(n){var e=n.value;_((function(n){return(0,o.Z)((0,o.Z)({},n),{},{type:e})}))}})}),null!==C&&void 0!==C&&C._id?(0,Z.jsxs)(s.ZP,{padding:"8px",gap:8,fxDirection:"row",alignItems:"center",justifyContent:"space-between",children:[(0,Z.jsx)(v.x,{$align:"center",$size:15,$weight:500,children:(0,u.t)("Current")}),(0,Z.jsx)(v.x,{$align:"center",$size:15,$weight:600,children:null===e||void 0===e?void 0:e.label})]}):(0,Z.jsx)(c.Z,{label:(0,u.t)("Select properties group"),children:(0,Z.jsx)(p.Z,{options:L,onOptSelect:function(n){i&&n?i(n):z(n)},defaultFilterValue:(null===e||void 0===e?void 0:e._id)||(null===D||void 0===D?void 0:D._id)})})]})}}}]);
//# sourceMappingURL=588.2b4e6f2e.chunk.js.map