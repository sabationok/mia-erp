"use strict";(self.webpackChunkmia_erp=self.webpackChunkmia_erp||[]).push([[779],{1779:function(n,e,i){i.r(e),i.d(e,{CartPageRightTabsEnum:function(){return Q},cartPageTabsOptions:function(){return G},default:function(){return L}});var o,t,l=i(168),r=i(3350),d=i(8095),a=i(8495),u=i(6146),s=i(8839),c=i(6366),v=i(4897),f=i(2791),h=i(3665),p=i(2928),x=i(9006),g=i(2989),b=i(4781),j=i(2483),w=i(1413),m=i(9439),Z=i(1819),y=i(7824),k=i(8548),C=i(1500),P=i(1577),I=i(763),$=i(6492),S=i(3544),q=i(3299),z=i(6681),R=i(3329),D=function(n){var e,i=n.slot,o=n.onChangeQuantity,t=(0,f.useState)(null!==(e=null===i||void 0===i?void 0:i.quantity)&&void 0!==e?e:1),l=(0,m.Z)(t,2),a=l[0],u=l[1],s=(0,r.Fg)(),c=(0,f.useRef)(),v=(0,f.useRef)(),h=function(n){return function(){var e=null===i||void 0===i?void 0:i.quantity;!(0,I.isUndefined)(e)&&o?o(e+n<0?e:e+n):u((function(e){return e+n<0?e:e+n}))}},p=function(n){return{onMouseDown:function(){c.current=setTimeout((function(){v.current=setInterval((function(){u((function(e){return e+n<0?e:e+n}))}),100)}),250)},onMouseUp:function(){clearTimeout(c.current),clearInterval(v.current),c.current=void 0,v.current=void 0,o&&o(a)}}};return(0,f.useEffect)((function(){var n=null===i||void 0===i?void 0:i.quantity;(0,I.isUndefined)(n)||u(n)}),[null===i||void 0===i?void 0:i.quantity]),(0,R.jsxs)(d.ZP,{flexWrap:"wrap",gap:8,padding:"8px",fxDirection:"row",style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr"},children:[["cashback","bonus","discount"].map((function(n){var e;return(0,R.jsxs)(d.ZP,{background:s.fieldBackgroundColor,borderRadius:"4px",justifyContent:"space-between",children:[(0,R.jsx)($.x,{$weight:400,$size:12,$padding:"4px 6px",children:(0,S.t)(n)}),(0,R.jsx)($.x,{$weight:600,$size:13,$padding:"4px 6px",$align:"end",children:(0,q.pU)(null===i||void 0===i||null===(e=i[n])||void 0===e?void 0:e.amount)})]},n)})),["brutto","netto"].map((function(n){return(0,R.jsxs)(d.ZP,{background:s.fieldBackgroundColor,borderRadius:"4px",justifyContent:"space-between",children:[(0,R.jsx)($.x,{$weight:400,$size:12,$padding:"4px 6px",children:(0,S.t)(n)}),(0,R.jsx)($.x,{$weight:600,$size:13,$padding:"4px 6px",$align:"end",children:(0,q.pU)(null===i||void 0===i?void 0:i[n])})]},n)})),(0,R.jsxs)(d.ZP,{padding:"0 8px",children:[(0,R.jsx)(M,(0,w.Z)((0,w.Z)({variant:"def",iconSize:"15px",icon:"SmallArrowUp"},p(1)),{},{onClick:h(1)})),(0,R.jsx)(z.ZP,{value:a,name:"quantity",align:"center",onChange:function(n){u(Number(n.target.value))},onBlur:function(){o&&o(a)}}),(0,R.jsx)(M,(0,w.Z)((0,w.Z)({variant:"def",iconSize:"15px",icon:"SmallArrowDown"},p(-1)),{},{onClick:h(-1)}))]})]})},M=(0,r.ZP)(p.ZP)(o||(o=(0,l.Z)(["\n  height: 15px;\n\n  &:hover {\n    padding: 4px 0;\n  }\n"]))),B=i(1251),A=i(8189),T=function(n){var e,i=n.offer,o=n.warehouse,t=(n.slotId,n.onClose),l=(0,h.f9)(),r=(0,g.G2)(i),d=(0,f.useState)(),a=(0,m.Z)(d,2),u=a[0],s=a[1],v=(0,g.xj)(),p=(0,c.jD)(),x=p.actions.getSlotByVariationId(null===u||void 0===u?void 0:u._id),b=(0,f.useState)(null!==(e=null===x||void 0===x?void 0:x.quantity)&&void 0!==e?e:1),j=(0,m.Z)(b,2),Z=j[0],y=j[1],k=(0,f.useMemo)((function(){var n;return(0,C.Gn)((0,w.Z)((0,w.Z)((0,w.Z)({},x),{},{quantity:Z},null!==(n=null===u||void 0===u?void 0:u.price)&&void 0!==n?n:null===r||void 0===r?void 0:r.price),{},{offer:r,origin:u,warehouse:null!==o&&void 0!==o?o:null===r||void 0===r?void 0:r.warehouse}))}),[x,r,Z,u,o]);return(0,R.jsxs)(P.Z,{title:"Select variation | ".concat(null===r||void 0===r?void 0:r.label),fillHeight:!0,okButton:!0,onBackPress:t,children:[(0,R.jsx)(A.Z,{offer:r,onSelect:s,selected:u}),(0,R.jsx)(D,{slot:k,onChangeQuantity:y}),(0,R.jsx)(B.ze,{canAccept:!!u,onAcceptPress:function(){var n;null!==u&&void 0!==u&&u._id&&(null!==k&&void 0!==k&&k.tempId&&null!==k&&void 0!==k&&null!==(n=k.tempId)&&void 0!==n&&n.includes(null===u||void 0===u?void 0:u._id)?k.quantity!==(null===x||void 0===x?void 0:x.quantity)&&p.actions.update(k):null!==k&&void 0!==k&&k.warehouse&&p.actions.addSlot(k));v.push({query:(0,I.omit)(v.query,["offerId","slotId","variationId"])}),l.clearStack()}})]})};function U(n){var e,i,o=n.warehouse,t=n.slotId,l=n.onClose,r=(0,c.jD)(),d=(0,Z.xc)().get(y.d.offers).getAll,a=r.actions.getSlotWithMethods(t),u=(0,g.xj)(),v=(0,f.useState)(),p=(0,m.Z)(v,2),x=p[0],b=p[1],j=(0,f.useState)(null!==(e=null===a||void 0===a?void 0:a.quantity)&&void 0!==e?e:1),I=(0,m.Z)(j,2),$=I[0],S=I[1],q=(0,h.kw)(),z=(0,k.useOffersTableSettings)({searchState:null!==o&&void 0!==o&&o.label?{search:null!==(i=null===o||void 0===o?void 0:o.label)&&void 0!==i?i:"",param:{dataPath:"warehouse.label",label:"\u0421\u043a\u043b\u0430\u0434"}}:void 0}),M=z.tableConfig,A=z.isLoading,U=z.searchParams,W=(0,f.useMemo)((function(){return(0,C.Gn)((0,w.Z)((0,w.Z)({},a),{},{quantity:$},null===x||void 0===x?void 0:x.price))}),[a,$,null===x||void 0===x?void 0:x.price]);return(0,f.useEffect)((function(){var n,e=(0,C.P_)(null===U||void 0===U||null===(n=U.param)||void 0===n?void 0:n.dataPath,null===U||void 0===U?void 0:U.search);o&&d({data:{refresh:!0,params:e}})}),[]),(0,R.jsxs)(P.Z,{title:"Select offer",fillHeight:!0,okButton:!0,onBackPress:l,children:[(0,R.jsx)(s.ZP,(0,w.Z)((0,w.Z)({},M),{},{isLoading:null===A||void 0===A?void 0:A.offers,checkBoxes:!1,selectedRow:x,onRowClick:function(n){var e,i;null!==n&&void 0!==n&&n.rowData&&((null===n||void 0===n||null===(e=n.rowData)||void 0===e?void 0:e._id)&&u.push({query:{offerId:null===n||void 0===n||null===(i=n.rowData)||void 0===i?void 0:i._id}}),b(null===n||void 0===n?void 0:n.rowData))}})),x&&(0,R.jsx)(D,{slot:W,onChangeQuantity:S}),(0,R.jsx)(B.ze,{canAccept:!!x,onAcceptPress:function(){x&&q.create(T,{offer:x})}})]})}function W(n){n.warehouse;var e,i,o=(0,c.jD)(),t=(0,g.zR)(),l=o.actions.getSlotWithMethods(null===(e=t.query)||void 0===e?void 0:e.slotId),r=(0,f.useState)(l.variation),a=(0,m.Z)(r,1)[0],u=(0,f.useState)(null!==(i=null===l||void 0===l?void 0:l.quantity)&&void 0!==i?i:1),s=(0,m.Z)(u,2),v=s[0],h=s[1],p=(0,f.useMemo)((function(){var n,e;return(0,C.Gn)((0,w.Z)((0,w.Z)((0,w.Z)({variation:a},l),null!==(n=null===a||void 0===a?void 0:a.price)&&void 0!==n?n:l),{},{origin:null!==(e=null===a||void 0===a?void 0:a.price)&&void 0!==e?e:l.origin,quantity:v}))}),[l,v,a]);return(0,R.jsxs)(_,{fillHeight:!0,maxWidth:"380px",flex:1,padding:"0 8px 8px",children:[(0,R.jsx)(d.ZP,{flex:1}),(0,R.jsx)(D,{slot:p,onChangeQuantity:h}),(0,R.jsx)(B.ze,{canAccept:!!l.tempId&&l.quantity!==v,onAcceptPress:function(){l.setQty(v)}})]})}var F,H,_=(0,r.ZP)(d.ZP)(t||(t=(0,l.Z)(["\n  position: relative;\n  overflow: hidden;\n\n  background-color: ",";\n"])),(function(n){return n.theme.sideBarBackgroundColor})),V=i(4805),E=i(1467),O=i(9953),Q=function(n){return n.Slot="Slot",n.Chat="Chat",n}({}),G=(0,C.$G)(Q,(function(n){return(0,S.t)(n)}));function L(n){var e,i=n.path,o=(0,g.zR)(),t=(0,g.Zx)(),l=(0,V.useMediaQuery)({query:"(min-width: 960px)"}),r=(0,c.jD)();return(0,f.useEffect)((function(){t.cartId&&r.actions.setCartId(t.cartId)}),[]),(0,R.jsx)(u.vI,{path:i,children:(0,R.jsxs)(b.ZP,{children:[(0,R.jsxs)(N,{fillWidth:!0,flex:1,overflow:"hidden",fillHeight:!0,fxDirection:"row",gap:4,children:[(0,R.jsx)(d.ZP,{fillHeight:!0,flex:2,children:(0,R.jsx)(K,{})}),(0,R.jsxs)(J,{isVisible:l?void 0:!(null===o||void 0===o||null===(e=o.query)||void 0===e||!e.slotId),className:"RightSide",style:{},children:[(0,R.jsx)(O.Z,{options:G}),(0,R.jsx)(W,{})]})]}),(0,R.jsx)(j.j,{})]})})}var N=(0,r.ZP)(d.ZP)(F||(F=(0,l.Z)(["\n  ","\n"])),a.VU),J=(0,r.ZP)(d.ZP)(H||(H=(0,l.Z)(["\n  overflow: auto;\n\n  max-width: 100%;\n  height: 100%;\n\n  transition: ",";\n  background-color: ",";\n\n  border-color: ",";\n  border-style: solid;\n  border: 0;\n\n  // border-left-width: ",";\n  border-left-width: 1px;\n\n  @media screen and (min-width: 960px) {\n    min-width: 320px;\n  }\n\n  @media screen and (max-width: 960px) {\n    border-left-width: ",";\n\n    position: absolute;\n    top: 0;\n    right: 0;\n    z-index: 250;\n    height: 100%;\n\n    transform: translateX(","%);\n\n    box-shadow: ",";\n  }\n"])),(function(n){return n.theme.globals.timingFunctionMain}),(function(n){return n.theme.backgroundColorLight}),(function(n){return n.theme.trBorderClr}),(function(n){return n.isVisible?"1px":0}),(function(n){return n.isVisible?"1px":0}),(function(n){return n.isVisible?0:100}),(function(n){return n.isVisible?"0 12px 26px rgba(0, 0, 0, 0.25)":""}));function K(n){n.onSlotEditPress;var e=(0,g.zR)().query.cartId,i=(0,c.jD)(),o=(0,h.kw)(),t=(0,g.xj)(),l=(0,r.Fg)(),a=i.actions.getCurrentCart(e||E.JO),u=(0,f.useMemo)((function(){var n=null===a||void 0===a?void 0:a.ordersIds;return null===n||void 0===n?void 0:n.map((function(n,e){var l,r,a,u,c;if(!n)return null;var f=i.actions.getOrderById(n),h=null===(l=i.ordersSlotsMap)||void 0===l?void 0:l[n];return(0,R.jsxs)(x.y,{label:null!==(r=(0,S.t)("Warehouse")+": "+(null===f||void 0===f||null===(a=f.warehouse)||void 0===a?void 0:a.label))&&void 0!==r?r:(0,S.t)("undefined"),hideFooter:!0,renderTitle:(0,R.jsx)(d.ZP,{fxDirection:"row",gap:8,padding:"0 12px",children:(0,R.jsx)($.x,{$size:13,$weight:600,$padding:"2px 8px",children:null!==(u=(0,S.t)("Warehouse")+": "+(null===f||void 0===f||null===(c=f.warehouse)||void 0===c?void 0:c.label))&&void 0!==u?u:(0,S.t)("undefined")})}),children:[(0,R.jsx)(d.ZP,{minHeight:"300px",children:(0,R.jsx)(s.ZP,{tableData:h,hasSearch:!1,hasFilter:!1,checkBoxes:!0,onCheckboxChange:function(n){i.actions.setChecked({tempId:n.rowId,checked:n.checked})},onHeadCheckboxChange:function(e){i.actions.setChecked({orderId:n,checked:e.checked})},selectedRows:null===f||void 0===f?void 0:f.selectedIds,rowIds:null===f||void 0===f?void 0:f.slotsIds,keyExtractor:function(n){var e;return null!==(e=null===n||void 0===n?void 0:n.tempId)&&void 0!==e?e:"slot"},tableTitles:v.KS,onRowClick:function(){},actionsCreator:function(n){var e,l=null===(e=n.selectedRow)||void 0===e?void 0:e.tempId;return[{icon:"delete",disabled:!l,onClick:function(){l&&i.actions.removeSlot(l)}},{icon:"edit",disabled:!l,onClick:function(){l&&t.push({query:{slotId:l}})}},{icon:"plus",type:"onlyIconFilled",disabled:!(null!==f&&void 0!==f&&f.warehouse),onClick:function(){(null===f||void 0===f?void 0:f.warehouse)&&o.create(U,{warehouse:null===f||void 0===f?void 0:f.warehouse})}}]}})}),(0,R.jsx)(d.ZP,{padding:"8px 0",children:(0,R.jsx)(p.ZP,{variant:"filledMiddle",onClick:function(){i.actions.removeOrder(n)},children:"Remove"})})]},null!==n&&void 0!==n?n:e)}))}),[null===a||void 0===a?void 0:a.ordersIds,i.actions,i.ordersSlotsMap,o,t]);return(0,R.jsxs)(d.ZP,{overflow:"auto",fillHeight:!0,children:[(0,R.jsx)(x.y,{label:"Cart: ".concat(null===a||void 0===a?void 0:a.tempId),expandable:!0,isOpen:!0,hideFooter:!0,children:(0,R.jsxs)(d.ZP,{padding:"8px 12px",flexWrap:"wrap",fxDirection:"row",gap:10,children:[["cashback","bonus","discount"].map((function(n){var e,i;return(0,R.jsxs)(d.ZP,{background:l.backgroundColorSecondary,borderRadius:"2px",justifyContent:"space-between",children:[(0,R.jsx)($.x,{$weight:400,$size:12,$padding:"4px 6px",$textTransform:"capitalize",children:(0,S.t)(n)}),(0,R.jsx)($.x,{$weight:600,$size:13,$padding:"4px 6px",$align:"end",children:(0,q.pU)(null===a||void 0===a||null===(e=a.summary)||void 0===e||null===(i=e[n])||void 0===i?void 0:i.amount)})]},n)})),["brutto","netto"].map((function(n){var e;return(0,R.jsxs)(d.ZP,{background:l.backgroundColorSecondary,borderRadius:"2px",justifyContent:"space-between",children:[(0,R.jsx)($.x,{$weight:400,$size:12,$padding:"4px 6px",$textTransform:"capitalize",children:(0,S.t)(n)}),(0,R.jsx)($.x,{$weight:600,$size:13,$padding:"4px 6px",$align:"end",children:(0,q.pU)(null===a||void 0===a||null===(e=a.summary)||void 0===e?void 0:e[n])})]},n)}))]})}),(0,R.jsx)(d.ZP,{flex:1,gap:8,children:u}),(0,R.jsxs)(d.ZP,{fxDirection:"row",gap:12,padding:"16px",fillWidth:!0,alignItems:"center",justifyContent:"center",style:{position:"sticky",bottom:0,left:0,zIndex:100,backdropFilter:"blur(3px)"},children:[(0,R.jsx)(p.ZP,{variant:"outlinedMiddle",icon:"plus",disabled:!a,onClick:function(){o.create(U,{})},children:"Add slot"}),(0,R.jsx)(p.ZP,{variant:"filledMiddle",disabled:!a,onClick:function(){null===a||void 0===a||a.remove()},children:"Remove all"})]})]})}}}]);
//# sourceMappingURL=779.5067a5a7.chunk.js.map